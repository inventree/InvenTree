{% extends "panel.html" %}
{% load i18n %}
{% load inventree_extras %}
{% load plugin_extras %}

{% block label %}plugin-{{plugin_key}}{% endblock %}


{% block heading %}
{% blocktrans with name=plugin.human_name %}Plugin details for {{name}}{% endblocktrans %}
{% endblock %}

{% block content %}

<div class="row">
    <div class="col-md-6">
        <h4>{% trans "Plugin information" %}</h4>
        <table class='table table-striped table-condensed'>
            <col width='25'>
            <tr>
                <td></td>
                <td>{% trans "Name" %}</td>
                <td>{{ plugin.human_name }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-user'></span></span></td>
                <td>{% trans "Author" %}</td>
                <td>{{ plugin.author }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-calendar-alt'></span></td>
                <td>{% trans "Date" %}</td>
                <td>{{ plugin.pub_date }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-hashtag'></span></td>
                <td>{% trans "Version" %}</td>
                <td>{{ plugin.version }}{% include "clip.html" %}</td>
            </tr>
        </table>

        <p>{% trans 'The code information is pulled from the latest git commit for this plugin. It might not reflect official version numbers or information but the actual code running.' %}</p>
    </div>
    <div class="col-md-6">
        <h4>{% trans "Code information" %}</h4>
        <table class='table table-striped table-condensed'>
            <col width='25'>
            <tr>
                <td><span class='fas fa-user'></span></td>
                <td>{% trans "Commit Author" %}</td><td>{{ plugin.commit.author }} - {{ plugin.commit.mail }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-calendar-alt'></span></td>
                <td>{% trans "Commit Date" %}</td><td>{{ plugin.commit.date }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-code-branch'></span></td>
                <td>{% trans "Commit Hash" %}</td><td>{{ plugin.commit.hash }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='fas fa-envelope'></span></td>
                <td>{% trans "Commit Message" %}</td><td>{{ plugin.commit.message }}{% include "clip.html" %}</td>
            </tr>
            <tr>
                <td><span class='text-{{plugin.sign_color}} fas fa-check'></span></td>
                <td>{% trans "Commit Sign Status" %}</td>
                <td class="bg-{{plugin.sign_color}}">{% if plugin.commit.verified %}{{ plugin.commit.verified }}: {% endif%}{{ plugin.sign_state.msg }}</td>
            </tr>
            <tr>
                <td><span class='text-{{plugin.sign_color}} fas fa-key'></span></td>
                <td>{% trans "Commit Sign Key" %}</td>
                <td class="bg-{{plugin.sign_color}}">{{ plugin.commit.key }}{% include "clip.html" %}</td>
            </tr>
        </table>
    </div>
</div>

{% mixin_enabled plugin 'settings' as settings %}
{% if settings %}
<h4>{% trans "Settings" %}</h4>
{% plugin_settings plugin_key as plugin_settings %}

<table class='table table-striped table-condensed'>
    {% include "InvenTree/settings/header.html" %}
    <tbody>
        {% for setting in plugin_settings %}
            {% include "InvenTree/settings/setting.html" with key=setting%}
        {% endfor %}
    </tbody>
</table>
{% endif %}

{% mixin_enabled plugin 'urls' as urls %}
{% if urls %}
<h4>{% trans "URLs" %}</h4>
    {% define plugin.base_url as base %}
    <p>{% blocktrans %}The Base-URL for this plugin is <a href="/{{ base }}" target="_blank"><strong>{{ base }}</strong></a>.{% endblocktrans %}</p>

    <table class='table table-striped table-condensed'>
        <thead>
            <tr>
                <th>{% trans "Name" %}</th>
                <th>{% trans "URL" %}</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for key, entry in plugin.urlpatterns.reverse_dict.items %}{% if key %}
            <tr>
                <td>{{key}}</td>
                <td>{{entry.1}}</td>
                <td><a class="btn btn-primary btn-small" href="/{{ base }}{{entry.1}}" target="_blank">{% trans 'open in new tab' %}</a></td>
            </tr>
            {% endif %}{% endfor %}
        </tbody>
    </table>
{% endif %}

{% endblock %}
