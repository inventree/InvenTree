{"version":3,"file":"TaxManagementPanel-DrF1kcBT.js","sources":["../../../../../../frontend/src/forms/TaxForms.tsx","../../../../../../frontend/src/tables/settings/TaxConfigurationTable.tsx","../../../../../../frontend/src/pages/Index/Settings/AdminCenter/TaxManagementPanel.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { useMemo } from 'react';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\n\n/**\n * Construct a set of fields for creating / editing a TaxConfiguration instance\n */\nexport function taxConfigurationFields(): ApiFormFieldSet {\n  return useMemo(() => {\n    const fields: ApiFormFieldSet = {\n      name: {\n        field_type: 'string',\n        required: true,\n        description: t`Human-readable name for this tax configuration`\n      },\n      description: {\n        field_type: 'string',\n        description: t`Optional description of the tax configuration`\n      },\n      year: {\n        field_type: 'integer',\n        required: true,\n        description: t`The year this tax configuration applies to`\n      },\n      rate: {\n        field_type: 'decimal',\n        required: true,\n        description: t`Tax rate as a percentage (e.g., 10.00 for 10%)`\n      },\n      currency: {\n        field_type: 'choice',\n        required: true,\n        description: t`Currency for this tax configuration`,\n        api_url: apiUrl(ApiEndpoints.currency_list),\n        pk_field: 'currency',\n        modelRenderer: (instance: any) => instance.currency\n      },\n      is_active: {\n        field_type: 'boolean',\n        description: t`Whether this configuration is currently active`\n      },\n      is_inclusive: {\n        field_type: 'boolean',\n        description: t`Whether prices include tax (True) or exclude tax (False)`\n      },\n      applies_to_sales: {\n        field_type: 'boolean',\n        description: t`Whether this tax applies to sales orders`\n      },\n      applies_to_purchases: {\n        field_type: 'boolean',\n        description: t`Whether this tax applies to purchase orders`\n      }\n    };\n\n    return fields;\n  }, []);\n}\n","import { t } from '@lingui/core/macro';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { RowDeleteAction, RowEditAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { RowAction, TableColumn } from '@lib/types/Tables';\nimport { taxConfigurationFields } from '../../forms/TaxForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { BooleanColumn } from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/**\n * Table for displaying list of tax configurations\n */\nexport default function TaxConfigurationTable() {\n  const table = useTable('tax-configurations');\n\n  const user = useUserState();\n\n  const columns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'name',\n        sortable: true,\n        title: t`Name`\n      },\n      {\n        accessor: 'year',\n        sortable: true,\n        title: t`Year`\n      },\n      {\n        accessor: 'rate',\n        sortable: true,\n        title: t`Rate (%)`,\n        render: (record: any) => `${record.rate}%`\n      },\n      {\n        accessor: 'currency',\n        sortable: true,\n        title: t`Currency`\n      },\n      BooleanColumn({\n        accessor: 'is_active',\n        title: t`Active`\n      }),\n      BooleanColumn({\n        accessor: 'is_inclusive',\n        title: t`Inclusive`\n      }),\n      BooleanColumn({\n        accessor: 'applies_to_sales',\n        title: t`Sales`\n      }),\n      BooleanColumn({\n        accessor: 'applies_to_purchases',\n        title: t`Purchases`\n      })\n    ];\n  }, []);\n\n  const newTaxConfiguration = useCreateApiFormModal({\n    url: ApiEndpoints.tax_configuration_list,\n    title: t`Add Tax Configuration`,\n    fields: taxConfigurationFields(),\n    table: table\n  });\n\n  const [selectedTaxConfiguration, setSelectedTaxConfiguration] = useState<\n    number | undefined\n  >(undefined);\n\n  const editTaxConfiguration = useEditApiFormModal({\n    url: ApiEndpoints.tax_configuration_list,\n    pk: selectedTaxConfiguration,\n    title: t`Edit Tax Configuration`,\n    fields: taxConfigurationFields(),\n    table: table\n  });\n\n  const deleteTaxConfiguration = useDeleteApiFormModal({\n    url: ApiEndpoints.tax_configuration_list,\n    pk: selectedTaxConfiguration,\n    title: t`Delete Tax Configuration`,\n    table: table\n  });\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.admin),\n          onClick: () => {\n            setSelectedTaxConfiguration(record.pk);\n            editTaxConfiguration.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.admin),\n          onClick: () => {\n            setSelectedTaxConfiguration(record.pk);\n            deleteTaxConfiguration.open();\n          }\n        })\n      ];\n    },\n    [user, editTaxConfiguration, deleteTaxConfiguration]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add'\n        onClick={() => newTaxConfiguration.open()}\n        tooltip={t`Add tax configuration`}\n        hidden={!user.hasAddRole(UserRoles.admin)}\n      />\n    ];\n  }, [user, newTaxConfiguration]);\n\n  return (\n    <>\n      {newTaxConfiguration.modal}\n      {editTaxConfiguration.modal}\n      {deleteTaxConfiguration.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.tax_configuration_list)}\n        tableState={table}\n        columns={columns}\n        props={{\n          rowActions: rowActions,\n          tableActions: tableActions,\n          enableSelection: true,\n          enableSearch: true,\n          enableFilters: true,\n          enablePagination: true,\n          enableColumnSwitching: true\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Stack } from '@mantine/core';\n\nimport { StylishText } from '../../../../components/items/StylishText';\nimport TaxConfigurationTable from '../../../../tables/settings/TaxConfigurationTable';\n\nexport default function TaxManagementPanel() {\n  return (\n    <Stack gap='xs'>\n      <StylishText size='lg'>{t`Tax Configurations`}</StylishText>\n      <TaxConfigurationTable />\n    </Stack>\n  );\n}\n"],"names":["taxConfigurationFields","useMemo","name","field_type","required","description","_i18n","_","id","year","rate","currency","api_url","apiUrl","ApiEndpoints","currency_list","pk_field","modelRenderer","instance","is_active","is_inclusive","applies_to_sales","applies_to_purchases","TaxConfigurationTable","table","useTable","user","useUserState","columns","accessor","sortable","title","render","record","BooleanColumn","newTaxConfiguration","useCreateApiFormModal","url","tax_configuration_list","fields","selectedTaxConfiguration","setSelectedTaxConfiguration","useState","undefined","editTaxConfiguration","useEditApiFormModal","pk","deleteTaxConfiguration","useDeleteApiFormModal","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","UserRoles","admin","onClick","open","RowDeleteAction","hasDeleteRole","tableActions","AddItemButton","hasAddRole","jsxs","Fragment","modal","jsx","InvenTreeTable","enableSelection","enableSearch","enableFilters","enablePagination","enableColumnSwitching","TaxManagementPanel","Stack","StylishText"],"mappings":"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"}
