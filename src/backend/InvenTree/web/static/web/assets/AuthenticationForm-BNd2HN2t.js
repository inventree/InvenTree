import{j as s,bL as R,i as e,H as L,fm as A,fn as E,fo as z,fp as M,fq as C,fr as N,fs as O,ft as q,fu as G,fv as V,fw as D,fx as K,cv as W,u as T,r as v,G as x,bR as B,S as I,c7 as f,fy as w,fz as Z,D as S,A as d,L as Q,bW as U,B as X,s as Y}from"./vendor-C9xuDR-n.js";import{P as H,c as P,b as J,O as $,T as c,Q as ss,V as es,W as as,a as is,e as ts,A as rs}from"./index-CjCZvRJF.js";import{e as os}from"./Alerts-K0Anwiwi.js";import{u as k}from"./use-form-DJYGXPAI.js";import{a as F,u as ns}from"./ThemeContext-s5vo4YrD.js";const ls={google:s.jsx(K,{}),github:s.jsx(D,{}),facebook:s.jsx(V,{}),discord:s.jsx(G,{}),twitter:s.jsx(q,{}),bitbucket:s.jsx(O,{}),flickr:s.jsx(N,{}),gitlab:s.jsx(C,{}),reddit:s.jsx(M,{}),twitch:s.jsx(z,{}),microsoft:s.jsx(E,{})};function y({provider:a}){return s.jsx(R,{label:e._({id:"pQOGQK"}),children:s.jsx(L,{leftSection:ds(a),radius:"xl",component:"a",onClick:()=>H(a),children:a.name})})}function ds(a){return ls[a.id]||s.jsx(A,{})}function xs(){const a=k({initialValues:{username:"",password:"",code:""}}),j=k({initialValues:{email:""}}),[o,u]=W(!0),[n,_,m]=P(T(i=>[i.auth_config,i.sso_enabled,i.password_forgotten_enabled])),p=F(),g=ns(),{isLoggedIn:r}=J(),[b,t]=v.useState(!1);function h(){t(!0),o===!0?$(a.values.username,a.values.password,p,a.values.code).then(i=>{t(!1),r()?(c({title:e._({id:"6cPKtu"}),message:e._({id:"uKMMk4"})}),ss(p,g==null?void 0:g.state)):i||c({title:e._({id:"4GKuCs"}),message:e._({id:"tnaYa/"}),success:!1})}).catch(()=>{Y({title:e._({id:"4GKuCs"}),message:e._({id:"tnaYa/"}),color:"red"})}):es(j.values.email).then(i=>{t(!1),(i==null?void 0:i.status)==="ok"?c({title:e._({id:"XAIcYu"}),message:e._({id:"R2JMfc"})}):c({title:e._({id:"MMJM0z"}),message:e._({id:"tnaYa/"}),success:!1})})}return s.jsxs(s.Fragment,{children:[_()?s.jsxs(s.Fragment,{children:[s.jsx(x,{grow:!0,mb:"md",mt:"md",children:n==null?void 0:n.socialaccount.providers.map(i=>s.jsx(y,{provider:i},i.id))}),s.jsx(B,{label:e._({id:"zTZjMy"}),labelPosition:"center",my:"lg"})]}):null,s.jsxs("form",{onSubmit:a.onSubmit(()=>{}),children:[o?s.jsxs(I,{gap:0,children:[s.jsx(f,{required:!0,label:e._({id:"7sNhEz"}),"aria-label":"login-username",placeholder:e._({id:"k1RkIL"}),...a.getInputProps("username")}),s.jsx(w,{required:!0,label:e._({id:"8ZsakT"}),"aria-label":"login-password",placeholder:e._({id:"9TO8nT"}),...a.getInputProps("password")}),s.jsx(Z,{children:s.jsx(f,{name:"TOTP",...a.getInputProps("code"),hidden:!0})}),m()===!0&&s.jsx(x,{justify:"space-between",mt:"0",children:s.jsx(S,{component:"button",type:"button",c:"dimmed",size:"xs",onClick:()=>p("/reset-password"),children:s.jsx(d,{id:"RfwZxd"})})})]}):s.jsx(I,{children:s.jsx(f,{required:!0,label:e._({id:"O3oNi5"}),description:e._({id:"Wr5sDQ"}),placeholder:"email@example.org",...j.getInputProps("email")})}),s.jsxs(x,{justify:"space-between",mt:"xl",children:[s.jsx(S,{component:"button",type:"button",c:"dimmed",size:"xs",onClick:()=>u.toggle(),children:o?s.jsx(d,{id:"7ZOmjI"}):s.jsx(d,{id:"vZk5Sm"})}),s.jsx(L,{type:"submit",disabled:b,onClick:h,children:b?s.jsx(Q,{size:"sm"}):s.jsx(s.Fragment,{children:o?s.jsx(d,{id:"ADVQ46"}):s.jsx(d,{id:"i/TzEU"})})})]})]})]})}function fs(){const a=k({initialValues:{username:"",email:"",password:"",password2:""}}),j=F(),[o,u,n]=P(T(r=>[r.auth_config,r.registration_enabled,r.sso_registration_enabled])),[_,m]=v.useState(!1);async function p(){if(a.values.password!==a.values.password2){a.setFieldError("password2",e._({id:"lpIMne"}));return}m(!0);const{password2:r,...b}=a.values;await as(),is.post(ts(rs.auth_signup),b,{headers:{Authorization:""}}).then(t=>{(t==null?void 0:t.status)===200&&(m(!1),c({title:e._({id:"EoCs7m"}),message:e._({id:"n2c6Ul"})}),j("/home"))}).catch(t=>{var h;if(((h=t.response)==null?void 0:h.status)===400){m(!1);const i={};for(const l of t.response.data.errors)i[l.param]||(i[l.param]=[]),i[l.param].push(l.message);for(const l in i)a.setFieldError(l,i[l]);c({title:e._({id:"ccnxuA"}),message:e._({id:"SxviKF"}),success:!1})}})}const g=u()&&n();return s.jsxs(s.Fragment,{children:[u()&&s.jsxs("form",{onSubmit:a.onSubmit(()=>{}),children:[s.jsxs(I,{gap:0,children:[s.jsx(f,{required:!0,label:e._({id:"7sNhEz"}),"aria-label":"register-username",placeholder:e._({id:"k1RkIL"}),...a.getInputProps("username")}),s.jsx(f,{required:!0,label:e._({id:"O3oNi5"}),"aria-label":"register-email",description:e._({id:"kXXdWU"}),placeholder:"email@example.org",...a.getInputProps("email")}),s.jsx(w,{required:!0,label:e._({id:"8ZsakT"}),"aria-label":"register-password",placeholder:e._({id:"9TO8nT"}),...a.getInputProps("password")}),s.jsx(w,{required:!0,label:e._({id:"NK5XEe"}),"aria-label":"register-password-repeat",placeholder:e._({id:"R1OtIL"}),...a.getInputProps("password2")})]}),s.jsx(x,{justify:"space-between",mt:"xl",children:s.jsx(L,{type:"submit",disabled:_,onClick:p,fullWidth:!0,children:s.jsx(d,{id:"fgLNSM"})})})]}),g&&s.jsx(B,{label:e._({id:"IES56a"}),labelPosition:"center",my:"lg"}),n()&&s.jsx(x,{grow:!0,mb:"md",mt:"md",children:o==null?void 0:o.socialaccount.providers.map(r=>s.jsx(y,{provider:r},r.id))}),!u()&&!n()&&s.jsxs(U,{title:e._({id:"l+/XTD"}),color:"orange",children:[s.jsx(X,{children:e._({id:"0nrVnP"})}),os("INVE-W11")]})]})}export{xs as A,fs as R};
//# sourceMappingURL=AuthenticationForm-BNd2HN2t.js.map
