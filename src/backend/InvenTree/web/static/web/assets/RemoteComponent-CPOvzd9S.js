import{r as e,i as x,j as n,S as h,bW as R,B as j,d as g,y as v,M as E}from"./vendor-C9xuDR-n.js";import{u as y,a as C,q as _,C as S}from"./index-CjCZvRJF.js";import{A as w}from"./DesktopAppView-EZRUo9CM.js";import{L as $,k as H}from"./ThemeContext-s5vo4YrD.js";import{f as b}from"./PluginSource-BoO63rMJ.js";var L=(r=>(r.dashboard="dashboard",r.panel="panel",r.template_editor="template_editor",r.template_preview="template_preview",r.navigation="navigation",r))(L||{});const M=(r,d)=>e.forwardRef((a,c)=>{const o=e.useRef(null),[f,u]=e.useState(void 0),s=e.useRef(null),i=e.useRef(null),l=e.useRef(null);return e.useImperativeHandle(c,()=>({setCode:t=>{i.current?i.current(t):s.current=t},getCode:()=>{var t;return(t=l.current)==null?void 0:t.call(l)}})),e.useEffect(()=>{let t;return(async()=>{try{t=await r({ref:o.current,registerHandlers:({getCode:p,setCode:m})=>{i.current=m,l.current=p,s.current&&m(s.current)},template:d})}catch(p){u(x._({id:"t3xUfw"})),console.error(p)}})(),()=>{typeof t=="function"&&t()}},[]),n.jsxs(h,{gap:"xs",style:{display:"flex",flex:1},children:[f&&n.jsx(R,{color:"red",title:x._({id:"JDFeOe"}),icon:n.jsx(g,{}),children:n.jsx(j,{children:f})}),n.jsx("div",{ref:o,style:{display:"flex",flex:1}})]})}),O=(r,d)=>e.forwardRef((a,c)=>{const o=e.useRef(null),[f,u]=e.useState(void 0),s=e.useRef(null);return e.useImperativeHandle(c,()=>({updatePreview:(...i)=>{var l;return(l=s.current)==null?void 0:l.call(s,...i)}})),e.useEffect(()=>{(async()=>{try{r({ref:o.current,registerHandlers:({updatePreview:i})=>{s.current=i},template:d})}catch(i){u(x._({id:"KJx0of"})),console.error(i)}})()},[]),n.jsxs(h,{gap:"xs",style:{display:"flex",flex:1},children:[f&&n.jsx(R,{color:"red",title:x._({id:"OqfJdc"}),icon:n.jsx(g,{}),children:n.jsx(j,{children:f})}),n.jsx("div",{ref:o,style:{display:"flex",flex:1}})]})});function B({source:r,defaultFunctionName:d,context:a}){const c=e.useRef(null),o=e.useRef(null);e.useEffect(()=>{c.current&&o.current===null&&(o.current=v.createRoot(c.current))},[o]);const[f,u]=e.useState(void 0),s=e.useMemo(()=>{const{getHost:l}=y.getState(),t=new URL(r,l());return t.pathname.includes(":")&&t.pathname.split(":")[1]||d},[r,d]),i=e.useCallback(()=>{if(!o.current)return;const l={...a,reloadContent:i};r&&d?b(r,s).then(t=>{var p;if(t)try{t.length>1?t(c.current,l):(p=o.current)==null||p.render(n.jsx(w,{client:_,api:C,children:n.jsx(E,{theme:l.theme,defaultColorScheme:l.colorScheme,children:n.jsx($,{children:t(l)})})})),u("")}catch(m){u(`${m}`),console.error(m)}else u(`${r} / ${t}`)}).catch(t=>{console.error(`ERR: Failed to load remote plugin function: ${r} /${s}`)}):u(`${x._({id:"wOa7Q9"})} - ${r} /${s}`)},[c.current,o.current,r,d,a]);return e.useEffect(()=>{i()},[s,o.current,a.id,a.model,a.instance,a.user,a.colorScheme,a.locale,a.context]),n.jsx(H,{label:S(`RemoteComponent-${s}`),children:n.jsxs(h,{gap:"xs",children:[f&&n.jsx(R,{color:"red",title:x._({id:"HY5802"}),icon:n.jsx(g,{}),children:n.jsxs(j,{children:[x._({id:"IYgnvh"}),": ",f]})}),c&&n.jsx("div",{ref:c})]})})}export{L as P,B as R,O as a,M as g};
//# sourceMappingURL=RemoteComponent-CPOvzd9S.js.map
