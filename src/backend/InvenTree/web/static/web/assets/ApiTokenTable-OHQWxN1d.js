import{r as i,cv as C,i as s,j as e,bU as F,A as u,bm as P,N as U,B,Y as v,cH as M,ee as z}from"./vendor-C9xuDR-n.js";import{b as E,A as S,q as I}from"./UseForm-D7tPXWOh.js";import{A as o,e as d,a as w,E as L}from"./index-CjCZvRJF.js";import{C as W,S as q}from"./ThemeContext-s5vo4YrD.js";import{u as G,U as O,I as R}from"./InvenTreeTable-8QCr5F7I.js";import{B as p}from"./ColumnRenderers-Bk0OcEIT.js";function Z({only_myself:r=!0}){const[l,x]=i.useState(""),[m,{open:b,close:j}]=C(!1),c=E({url:o.user_tokens,title:s._({id:"PxJ9W6"}),fields:{name:{}},successMessage:s._({id:"jUAqIc"}),onFormSuccess:t=>{x(t.token),b(),n.refreshTable()}}),h=i.useMemo(()=>r?[e.jsx(S,{tooltip:s._({id:"PxJ9W6"}),onClick:()=>c.open()},"generate")]:[],[r]),n=G("api-tokens","id"),k=i.useMemo(()=>{const t=[{accessor:"name",title:s._({id:"6YtxFj"}),sortable:!0},p({accessor:"active",title:s._({id:"F6pfE9"}),sortable:!1}),p({accessor:"revoked",title:s._({id:"xGiT1z"})}),{accessor:"token",title:s._({id:"TP9/K5"}),render:a=>e.jsxs(e.Fragment,{children:[a.token," ",a.in_use?e.jsx(F,{color:"green",children:e.jsx(u,{id:"OxPEUg"})}):null]})},{accessor:"last_seen",title:s._({id:"bLZksC"}),sortable:!0},{accessor:"expiry",title:s._({id:"agO/T/"}),sortable:!0},{accessor:"created",title:s._({id:"d+F6q9"}),sortable:!0}];return r||t.push({accessor:"user",title:s._({id:"7PzzBU"}),sortable:!0,render:a=>a.user_detail?e.jsx(I,{instance:a.user_detail}):a.user}),t},[r]),_=i.useMemo(()=>{const t=[{name:"revoked",label:s._({id:"xGiT1z"}),description:s._({id:"iFQOwR"})}];return r||t.push(O({name:"user",label:s._({id:"7PzzBU"}),description:s._({id:"FVjW63"})})),t},[r]),T=i.useCallback(t=>[{title:s._({id:"GXsAby"}),color:"red",hidden:!t.active||t.in_use,icon:e.jsx(P,{}),onClick:()=>{A(t.id)}}],[]),A=async t=>{let a=d(o.user_tokens,t);r||(a+="?all_users=true"),w.delete(a).then(()=>{n.refreshTable()}).catch(g=>{L({error:g,title:s._({id:"LQLPLZ"})})})},f=i.useMemo(()=>r?{}:{all_users:!0},[r]);return e.jsxs(e.Fragment,{children:[r&&e.jsxs(e.Fragment,{children:[c.modal,e.jsxs(U,{opened:m,onClose:j,title:e.jsx(q,{size:"xl",children:s._({id:"TP9/K5"})}),centered:!0,children:[e.jsx(B,{c:"dimmed",children:e.jsx(u,{id:"VWjAuB"})}),e.jsx(v,{p:"sm",children:e.jsxs(M,{children:[e.jsx(z,{children:l}),e.jsx(W,{value:l})]})})]})]}),e.jsx(R,{tableState:n,url:d(o.user_tokens),columns:k,props:{params:f,rowActions:T,enableSearch:!1,enableColumnSwitching:!1,tableActions:h,tableFilters:_}})]})}export{Z as A};
//# sourceMappingURL=ApiTokenTable-OHQWxN1d.js.map
