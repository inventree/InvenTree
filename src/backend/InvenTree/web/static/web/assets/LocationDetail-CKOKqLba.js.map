{"version":3,"file":"LocationDetail-CKOKqLba.js","sources":["../../../../../../frontend/src/tables/stock/StockLocationTable.tsx","../../../../../../frontend/src/pages/stock/LocationDetail.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Group } from '@mantine/core';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { type RowAction, RowEditAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { ActionDropdown } from '../../components/items/ActionDropdown';\nimport { ApiIcon } from '../../components/items/ApiIcon';\nimport { stockLocationFields } from '../../forms/StockForms';\nimport { InvenTreeIcon } from '../../functions/icons';\nimport {\n  useBulkEditApiFormModal,\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  BooleanColumn,\n  DescriptionColumn,\n  TenantColumn\n} from '../ColumnRenderers';\nimport { TenantFilter } from '../Filter';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/**\n * Stock location table\n */\nexport function StockLocationTable({ parentId }: Readonly<{ parentId?: any }>) {\n  const table = useTable('stocklocation');\n  const user = useUserState();\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'cascade',\n        label: t`Include Sublocations`,\n        description: t`Include sublocations in results`\n      },\n      {\n        name: 'structural',\n        label: t`Structural`,\n        description: t`Show structural locations`\n      },\n      {\n        name: 'external',\n        label: t`External`,\n        description: t`Show external locations`\n      },\n      {\n        name: 'has_location_type',\n        label: t`Has location type`\n      },\n      {\n        name: 'location_type',\n        label: t`Location Type`,\n        description: t`Filter by location type`,\n        apiUrl: apiUrl(ApiEndpoints.stock_location_type_list),\n        model: ModelType.stocklocationtype,\n        modelRenderer: (instance: any) => instance.name\n      },\n      TenantFilter()\n    ];\n  }, []);\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'name',\n        switchable: false,\n        render: (record: any) => (\n          <Group gap='xs'>\n            {record.icon && <ApiIcon name={record.icon} />}\n            {record.name}\n          </Group>\n        )\n      },\n      DescriptionColumn({}),\n      {\n        accessor: 'pathstring',\n        sortable: true\n      },\n      {\n        accessor: 'items',\n        sortable: true\n      },\n      TenantColumn({}),\n      BooleanColumn({\n        accessor: 'structural',\n        defaultVisible: false\n      }),\n      BooleanColumn({\n        accessor: 'external',\n        defaultVisible: false\n      }),\n      {\n        accessor: 'location_type',\n        sortable: false,\n        render: (record: any) => record.location_type_detail?.name\n      }\n    ];\n  }, []);\n\n  const newLocation = useCreateApiFormModal({\n    url: ApiEndpoints.stock_location_list,\n    title: t`Add Stock Location`,\n    fields: stockLocationFields(),\n    focus: 'name',\n    initialData: {\n      parent: parentId\n    },\n    follow: true,\n    modelType: ModelType.stocklocation,\n    table: table\n  });\n\n  const [selectedLocation, setSelectedLocation] = useState<number>(-1);\n\n  const editLocation = useEditApiFormModal({\n    url: ApiEndpoints.stock_location_list,\n    pk: selectedLocation,\n    title: t`Edit Stock Location`,\n    fields: stockLocationFields(),\n    onFormSuccess: (record: any) => table.updateRecord(record)\n  });\n\n  const setParent = useBulkEditApiFormModal({\n    url: ApiEndpoints.stock_location_list,\n    items: table.selectedIds,\n    title: t`Set Parent Location`,\n    fields: {\n      parent: {}\n    },\n    onFormSuccess: table.refreshTable\n  });\n\n  const tableActions = useMemo(() => {\n    const can_add = user.hasAddRole(UserRoles.stock_location);\n    const can_edit = user.hasChangeRole(UserRoles.stock_location);\n\n    return [\n      <ActionDropdown\n        tooltip={t`Location Actions`}\n        icon={<InvenTreeIcon icon='location' />}\n        disabled={!table.hasSelectedRecords}\n        actions={[\n          {\n            name: t`Set Parent`,\n            icon: <InvenTreeIcon icon='location' />,\n            tooltip: t`Set parent location for the selected items`,\n            hidden: !can_edit,\n            disabled: !table.hasSelectedRecords,\n            onClick: () => {\n              setParent.open();\n            }\n          }\n        ]}\n      />,\n      <AddItemButton\n        key='add-stock-location'\n        tooltip={t`Add Stock Location`}\n        onClick={() => newLocation.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user, table.hasSelectedRecords]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      const can_edit = user.hasChangeRole(UserRoles.stock_location);\n\n      return [\n        RowEditAction({\n          hidden: !can_edit,\n          onClick: () => {\n            setSelectedLocation(record.pk);\n            editLocation.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {newLocation.modal}\n      {editLocation.modal}\n      {setParent.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.stock_location_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          enableSelection: true,\n          enableDownload: true,\n          enableLabels: true,\n          enableReports: true,\n          params: {\n            parent: parentId,\n            top_level: parentId === undefined ? true : undefined\n          },\n          tableFilters: tableFilters,\n          tableActions: tableActions,\n          rowActions: rowActions,\n          modelType: ModelType.stocklocation\n        }}\n      />\n    </>\n  );\n}\n","import { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport { getDetailUrl } from '@lib/functions/Navigation';\nimport { t } from '@lingui/core/macro';\nimport { Group, Skeleton, Stack, Text } from '@mantine/core';\nimport { IconInfoCircle, IconPackages, IconSitemap } from '@tabler/icons-react';\nimport { useMemo, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { api } from '../../App';\nimport { useBarcodeScanDialog } from '../../components/barcodes/BarcodeScanDialog';\nimport AdminButton from '../../components/buttons/AdminButton';\nimport { PrintingActions } from '../../components/buttons/PrintingActions';\nimport {\n  type DetailsField,\n  DetailsTable\n} from '../../components/details/Details';\nimport { ItemDetailsGrid } from '../../components/details/ItemDetails';\nimport {\n  BarcodeActionDropdown,\n  DeleteItemAction,\n  EditItemAction,\n  OptionsActionDropdown\n} from '../../components/items/ActionDropdown';\nimport { ApiIcon } from '../../components/items/ApiIcon';\nimport InstanceDetail from '../../components/nav/InstanceDetail';\nimport NavigationTree from '../../components/nav/NavigationTree';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport LocateItemButton from '../../components/plugins/LocateItemButton';\nimport {\n  type StockOperationProps,\n  stockLocationFields\n} from '../../forms/StockForms';\nimport { InvenTreeIcon } from '../../functions/icons';\nimport {\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport { useStockAdjustActions } from '../../hooks/UseStockAdjustActions';\nimport { useUserState } from '../../states/UserState';\nimport { PartListTable } from '../../tables/part/PartTable';\nimport { StockItemTable } from '../../tables/stock/StockItemTable';\nimport { StockLocationTable } from '../../tables/stock/StockLocationTable';\n\nexport default function Stock() {\n  const { id: _id } = useParams();\n\n  const id = useMemo(\n    () => (!Number.isNaN(Number.parseInt(_id || '', 10)) ? _id : undefined),\n    [_id]\n  );\n\n  const navigate = useNavigate();\n  const user = useUserState();\n\n  const [treeOpen, setTreeOpen] = useState(false);\n\n  const {\n    instance: location,\n    refreshInstance,\n    instanceQuery\n  } = useInstance({\n    endpoint: ApiEndpoints.stock_location_list,\n    hasPrimaryKey: true,\n    pk: id,\n    params: {\n      path_detail: true\n    }\n  });\n\n  const detailsPanel = useMemo(() => {\n    if (id && instanceQuery.isFetching) {\n      return <Skeleton />;\n    }\n\n    const left: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'name',\n        label: t`Name`,\n        copy: true,\n        value_formatter: () => (\n          <Group gap='xs'>\n            {location.icon && <ApiIcon name={location.icon} />}\n            {location.name}\n          </Group>\n        )\n      },\n      {\n        type: 'text',\n        name: 'pathstring',\n        label: t`Path`,\n        icon: 'sitemap',\n        copy: true,\n        hidden: !id\n      },\n      {\n        type: 'text',\n        name: 'description',\n        label: t`Description`,\n        copy: true\n      },\n      {\n        type: 'link',\n        name: 'parent',\n        model_field: 'name',\n        icon: 'location',\n        label: t`Parent Location`,\n        model: ModelType.stocklocation,\n        hidden: !location?.parent\n      }\n    ];\n\n    const right: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'items',\n        icon: 'stock',\n        label: t`Stock Items`,\n        value_formatter: () => location?.items || '0'\n      },\n      {\n        type: 'text',\n        name: 'sublocations',\n        icon: 'location',\n        label: t`Sublocations`,\n        hidden: !location?.sublocations\n      },\n      {\n        type: 'text',\n        name: 'tenant_detail.name',\n        label: t`Tenant`,\n        icon: 'sitemap',\n        copy: true,\n        hidden: !location.tenant\n      },\n      {\n        type: 'boolean',\n        name: 'structural',\n        label: t`Structural`,\n        icon: 'sitemap'\n      },\n      {\n        type: 'boolean',\n        name: 'external',\n        label: t`External`\n      },\n      {\n        type: 'string',\n        // TODO: render location type icon here (ref: #7237)\n        name: 'location_type_detail.name',\n        label: t`Location Type`,\n        hidden: !location?.location_type,\n        icon: 'packages'\n      }\n    ];\n\n    return (\n      <ItemDetailsGrid>\n        {id && location?.pk ? (\n          <DetailsTable item={location} fields={left} />\n        ) : (\n          <Text>{t`Top level stock location`}</Text>\n        )}\n        {id && location?.pk && <DetailsTable item={location} fields={right} />}\n      </ItemDetailsGrid>\n    );\n  }, [location, instanceQuery]);\n\n  const locationPanels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'details',\n        label: t`Location Details`,\n        icon: <IconInfoCircle />,\n        content: detailsPanel\n      },\n      {\n        name: 'sublocations',\n        label: id ? t`Sublocations` : t`Stock Locations`,\n        icon: <IconSitemap />,\n        content: <StockLocationTable parentId={id} />\n      },\n      {\n        name: 'stock-items',\n        label: t`Stock Items`,\n        icon: <IconPackages />,\n        content: (\n          <StockItemTable\n            tableName='location-stock'\n            allowAdd\n            params={{\n              location: id\n            }}\n          />\n        )\n      },\n      {\n        name: 'default_parts',\n        label: t`Default Parts`,\n        icon: <IconPackages />,\n        hidden: !location.pk,\n        content: (\n          <PartListTable\n            props={{\n              params: {\n                default_location: location.pk\n              }\n            }}\n          />\n        )\n      }\n    ];\n  }, [location, id]);\n\n  const editLocation = useEditApiFormModal({\n    url: ApiEndpoints.stock_location_list,\n    pk: id,\n    title: t`Edit Stock Location`,\n    fields: stockLocationFields(),\n    onFormSuccess: refreshInstance\n  });\n\n  const deleteOptions = useMemo(() => {\n    return [\n      {\n        value: 0,\n        display_name: t`Move items to parent location`\n      },\n      {\n        value: 1,\n        display_name: t`Delete items`\n      }\n    ];\n  }, []);\n\n  const deleteLocation = useDeleteApiFormModal({\n    url: ApiEndpoints.stock_location_list,\n    pk: id,\n    title: t`Delete Stock Location`,\n    fields: {\n      delete_stock_items: {\n        label: t`Items Action`,\n        description: t`Action for stock items in this location`,\n        field_type: 'choice',\n        choices: deleteOptions\n      },\n      delete_sub_location: {\n        label: t`Child Locations Action`,\n        description: t`Action for child locations in this location`,\n        field_type: 'choice',\n        choices: deleteOptions\n      }\n    },\n    onFormSuccess: () => {\n      if (location.parent) {\n        navigate(getDetailUrl(ModelType.stocklocation, location.parent));\n      } else {\n        navigate('/stock/');\n      }\n    }\n  });\n\n  const stockOperationProps: StockOperationProps = useMemo(() => {\n    return {\n      pk: location.pk,\n      model: 'location',\n      refresh: refreshInstance,\n      filters: {\n        in_stock: true\n      }\n    };\n  }, [location]);\n\n  const stockAdjustActions = useStockAdjustActions({\n    formProps: stockOperationProps,\n    enabled: true,\n    delete: false,\n    merge: false,\n    assign: false\n  });\n\n  const scanInStockItem = useBarcodeScanDialog({\n    title: t`Scan Stock Item`,\n    modelType: ModelType.stockitem,\n    callback: async (_barcode, response) => {\n      const item = response.stockitem.instance;\n\n      // Scan the stock item into the current location\n      return api\n        .post(apiUrl(ApiEndpoints.stock_transfer), {\n          location: location.pk,\n          items: [\n            {\n              pk: item.pk,\n              quantity: item.quantity\n            }\n          ]\n        })\n        .then(() => {\n          return {\n            success: t`Scanned stock item into location`\n          };\n        })\n        .catch((error) => {\n          console.error('Error scanning stock item:', error);\n          return {\n            error: t`Error scanning stock item`\n          };\n        });\n    }\n  });\n\n  const scanInStockLocation = useBarcodeScanDialog({\n    title: t`Scan Stock Location`,\n    modelType: ModelType.stocklocation,\n    callback: async (_barcode, response) => {\n      const pk = response.stocklocation.pk;\n\n      // Set the parent location\n      return api\n        .patch(apiUrl(ApiEndpoints.stock_location_list, pk), {\n          parent: location.pk\n        })\n        .then(() => {\n          return {\n            success: t`Scanned stock location into location`\n          };\n        })\n        .catch((error) => {\n          console.error('Error scanning stock location:', error);\n          return {\n            error: t`Error scanning stock location`\n          };\n        });\n    }\n  });\n\n  const locationActions = useMemo(\n    () => [\n      <AdminButton model={ModelType.stocklocation} id={location.pk} />,\n      <LocateItemButton locationId={location.pk} />,\n      location.pk ? (\n        <BarcodeActionDropdown\n          model={ModelType.stocklocation}\n          pk={location.pk}\n          hash={location?.barcode_hash}\n          perm={user.hasChangeRole(UserRoles.stock_location)}\n          actions={[\n            {\n              name: 'Scan in stock items',\n              icon: <InvenTreeIcon icon='stock' />,\n              tooltip: 'Scan item into this location',\n              onClick: scanInStockItem.open\n            },\n            {\n              name: 'Scan in container',\n              icon: <InvenTreeIcon icon='unallocated_stock' />,\n              tooltip: 'Scan container into this location',\n              onClick: scanInStockLocation.open\n            }\n          ]}\n        />\n      ) : null,\n      <PrintingActions\n        modelType={ModelType.stocklocation}\n        items={[location.pk ?? 0]}\n        hidden={!location?.pk}\n        enableLabels\n        enableReports\n      />,\n      stockAdjustActions.dropdown,\n      <OptionsActionDropdown\n        tooltip={t`Location Actions`}\n        actions={[\n          EditItemAction({\n            hidden: !id || !user.hasChangeRole(UserRoles.stock_location),\n            tooltip: t`Edit Stock Location`,\n            onClick: () => editLocation.open()\n          }),\n          DeleteItemAction({\n            hidden: !id || !user.hasDeleteRole(UserRoles.stock_location),\n            tooltip: t`Delete Stock Location`,\n            onClick: () => deleteLocation.open()\n          })\n        ]}\n      />\n    ],\n    [location, id, user, stockAdjustActions.dropdown]\n  );\n\n  const breadcrumbs = useMemo(\n    () => [\n      { name: t`Stock`, url: '/stock' },\n      ...(location.path ?? []).map((l: any) => ({\n        name: l.name,\n        url: getDetailUrl(ModelType.stocklocation, l.pk),\n        icon: l.icon ? <ApiIcon name={l.icon} /> : undefined\n      }))\n    ],\n    [location]\n  );\n\n  return (\n    <>\n      {editLocation.modal}\n      {deleteLocation.modal}\n      {scanInStockItem.dialog}\n      {scanInStockLocation.dialog}\n      <InstanceDetail\n        query={instanceQuery}\n        requiredRole={UserRoles.stock_location}\n      >\n        <Stack>\n          <NavigationTree\n            title={t`Stock Locations`}\n            modelType={ModelType.stocklocation}\n            endpoint={ApiEndpoints.stock_location_tree}\n            opened={treeOpen}\n            onClose={() => setTreeOpen(false)}\n            selectedId={location?.pk}\n          />\n          <PageDetail\n            title={(location?.name ?? id) ? t`Stock Location` : t`Stock`}\n            subtitle={location?.description}\n            icon={location?.icon && <ApiIcon name={location?.icon} />}\n            actions={locationActions}\n            editAction={editLocation.open}\n            editEnabled={\n              !!location?.pk &&\n              user.hasChangePermission(ModelType.stocklocation)\n            }\n            breadcrumbs={breadcrumbs}\n            lastCrumb={[\n              {\n                name: location.name,\n                url: `/stock/location/${location.pk}/`\n              }\n            ]}\n            breadcrumbAction={() => {\n              setTreeOpen(true);\n            }}\n          />\n          <PanelGroup\n            pageKey='stocklocation'\n            panels={locationPanels}\n            model={ModelType.stocklocation}\n            reloadInstance={refreshInstance}\n            id={location?.pk}\n            instance={location}\n          />\n        </Stack>\n        {stockAdjustActions.modals.map((modal) => modal.modal)}\n      </InstanceDetail>\n    </>\n  );\n}\n"],"names":["StockLocationTable","parentId","table","useTable","user","useUserState","tableFilters","useMemo","name","label","_i18n","_","id","description","apiUrl","ApiEndpoints","stock_location_type_list","model","ModelType","stocklocationtype","modelRenderer","instance","TenantFilter","tableColumns","accessor","switchable","render","record","jsxs","Group","icon","jsx","ApiIcon","DescriptionColumn","sortable","TenantColumn","BooleanColumn","defaultVisible","location_type_detail","newLocation","useCreateApiFormModal","url","stock_location_list","title","fields","stockLocationFields","focus","initialData","parent","follow","modelType","stocklocation","selectedLocation","setSelectedLocation","useState","editLocation","useEditApiFormModal","pk","onFormSuccess","updateRecord","setParent","useBulkEditApiFormModal","items","selectedIds","refreshTable","tableActions","can_add","hasAddRole","UserRoles","stock_location","can_edit","hasChangeRole","ActionDropdown","InvenTreeIcon","hasSelectedRecords","tooltip","hidden","disabled","onClick","open","AddItemButton","rowActions","useCallback","RowEditAction","Fragment","modal","InvenTreeTable","enableSelection","enableDownload","enableLabels","enableReports","params","top_level","undefined","Stock","_id","useParams","Number","isNaN","parseInt","navigate","useNavigate","treeOpen","setTreeOpen","location","refreshInstance","instanceQuery","useInstance","endpoint","hasPrimaryKey","path_detail","detailsPanel","isFetching","Skeleton","left","type","copy","value_formatter","model_field","right","sublocations","tenant","location_type","ItemDetailsGrid","DetailsTable","Text","locationPanels","IconInfoCircle","content","IconSitemap","IconPackages","StockItemTable","PartListTable","default_location","deleteOptions","value","display_name","deleteLocation","useDeleteApiFormModal","delete_stock_items","field_type","choices","delete_sub_location","getDetailUrl","stockOperationProps","refresh","filters","in_stock","stockAdjustActions","useStockAdjustActions","formProps","enabled","delete","merge","assign","scanInStockItem","useBarcodeScanDialog","stockitem","callback","_barcode","response","item","api","post","stock_transfer","quantity","then","success","catch","error","console","scanInStockLocation","patch","locationActions","AdminButton","LocateItemButton","BarcodeActionDropdown","barcode_hash","PrintingActions","dropdown","OptionsActionDropdown","EditItemAction","DeleteItemAction","hasDeleteRole","breadcrumbs","path","map","l","dialog","InstanceDetail","Stack","NavigationTree","stock_location_tree","PageDetail","hasChangePermission","PanelGroup","modals"],"mappings":"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"}
