import{j as e,r as l,bW as S,i as t,B as _,d as z,bY as r,S as u,ca as h,G,I as M,bm as A,be as L,bd as H,bz as N,s as X,fG as J,bL as k,fH as U}from"./vendor-C9xuDR-n.js";import{A as g}from"./ActionButton-C7Sx5Rz-.js";import{A as c,b as Z,c as Q,e as V}from"./index-CjCZvRJF.js";import{D as q}from"./DetailDrawer-BkiB3dje.js";import{u as $}from"./UseInstance-DkyyiXzC.js";import{I as d}from"./InfoItem-CrUEbduM.js";import{q as I,S as P,a as ee}from"./ThemeContext-s5vo4YrD.js";import{P as te}from"./SettingList-DkRkTAhU.js";import{u as ie}from"./PluginSource-BoO63rMJ.js";import{R as se}from"./RemoteComponent-CPOvzd9S.js";import{u as ae}from"./DesktopAppView-EZRUo9CM.js";import{u as w,b as le,a as oe}from"./UseForm-D7tPXWOh.js";import{u as re,I as de}from"./InvenTreeTable-8QCr5F7I.js";import{B as C}from"./ColumnRenderers-Bk0OcEIT.js";import"./YesNoButton-BFXy69VD.js";import"./index-DNosoft8.js";import"./QRCode-P5tCv9DA.js";import"./browser-CreoRYY6.js";import"./formatters-BZ1ASghj.js";function me({pluginAdmin:a}){const i=ie();return e.jsx(se,{source:a.source,defaultFunctionName:"renderPluginSettings",context:{...i,context:a.context}})}function ne({pluginKey:a,pluginInstance:i}){const{id:j}=I(),m=l.useMemo(()=>a||j||"",[a,j]),{instance:o}=$({endpoint:c.plugin_admin,pathParams:{key:m},defaultValue:{},hasPrimaryKey:!1,refetchOnMount:!0}),b=l.useMemo(()=>{var n;return!!((n=i==null?void 0:i.mixins)!=null&&n.settings)},[i]);return i.active?e.jsxs(r,{defaultValue:["plugin-details","plugin-settings"],multiple:!0,children:[e.jsxs(r.Item,{value:"plugin-details",children:[e.jsx(r.Control,{children:e.jsx(P,{size:"lg",children:t._({id:"5HArLW"})})}),e.jsx(r.Panel,{children:e.jsxs(u,{gap:"xs",children:[e.jsx(h,{withBorder:!0,children:e.jsx(u,{gap:"md",children:e.jsxs(u,{pos:"relative",gap:"xs",children:[e.jsx(d,{type:"text",name:t._({id:"6YtxFj"}),value:i==null?void 0:i.name}),e.jsx(d,{type:"text",name:t._({id:"Nu4oKW"}),value:i==null?void 0:i.meta.description}),e.jsx(d,{type:"text",name:t._({id:"VbeIOx"}),value:i==null?void 0:i.meta.author}),e.jsx(d,{type:"text",name:t._({id:"mYGY3B"}),value:i==null?void 0:i.meta.pub_date}),e.jsx(d,{type:"text",name:t._({id:"eE0JZ4"}),value:i==null?void 0:i.meta.version}),e.jsx(d,{type:"boolean",name:t._({id:"F6pfE9"}),value:i==null?void 0:i.active})]})})}),e.jsx(h,{withBorder:!0,children:e.jsx(u,{gap:"md",children:e.jsxs(u,{pos:"relative",gap:"xs",children:[(i==null?void 0:i.is_package)&&e.jsx(d,{type:"text",name:t._({id:"/L+cAM"}),value:i==null?void 0:i.package_name}),e.jsx(d,{type:"text",name:t._({id:"AJd5vK"}),value:i==null?void 0:i.meta.package_path}),e.jsx(d,{type:"boolean",name:t._({id:"++LBSt"}),value:i==null?void 0:i.is_builtin}),e.jsx(d,{type:"boolean",name:t._({id:"mGYa19"}),value:i==null?void 0:i.is_package})]})})})]})})]}),b&&e.jsxs(r.Item,{value:"plugin-settings",children:[e.jsx(r.Control,{children:e.jsx(P,{size:"lg",children:t._({id:"eKHY3W"})})}),e.jsx(r.Panel,{children:e.jsx(h,{withBorder:!0,children:e.jsx(te,{pluginKey:m})})})]}),(o==null?void 0:o.source)&&e.jsxs(r.Item,{value:"plugin-custom",children:[e.jsx(r.Control,{children:e.jsx(P,{size:"lg",children:t._({id:"BFm1Jm"})})}),e.jsx(r.Panel,{children:e.jsx(h,{withBorder:!0,children:e.jsx(me,{pluginAdmin:o})})})]})]}):e.jsx(S,{color:"red",title:t._({id:"nNlKYH"}),icon:e.jsx(z,{}),children:e.jsx(_,{children:t._({id:"xwdvWr"})})})}function ce({plugin:a}){return a!=null&&a.is_installed?a!=null&&a.active?e.jsx(k,{label:t._({id:"QqLLp2"}),children:e.jsx(M,{color:"green"})}):e.jsx(k,{label:t._({id:"s99Mc1"}),children:e.jsx(A,{color:"red"})}):e.jsx(k,{label:t._({id:"LtEW/l"}),children:e.jsx(U,{})})}function Ee(){const a=ae(),i=re("plugin"),j=ee(),m=Z(),{server:o}=Q(),b=l.useMemo(()=>[{accessor:"name",title:t._({id:"fOuPPd"}),sortable:!0,render:s=>{if(s)return e.jsxs(G,{justify:"left",children:[e.jsx(ce,{plugin:s}),e.jsx(_,{children:s.name})]})}},C({accessor:"active",sortable:!0,title:t._({id:"F6pfE9"})}),C({accessor:"is_builtin",sortable:!1,title:t._({id:"++LBSt"})}),C({accessor:"is_mandatory",sortable:!1,title:t._({id:"gFFgtV"})}),{accessor:"meta.description",title:t._({id:"Nu4oKW"}),sortable:!1,render:s=>s.active?s==null?void 0:s.meta.description:e.jsx(_,{style:{fontStyle:"italic"},size:"sm",children:t._({id:"9YdyZU"})})},{accessor:"meta.version",title:t._({id:"eE0JZ4"}),sortable:!1,render:s=>s==null?void 0:s.meta.version},{accessor:"meta.author",title:"Author",sortable:!1}],[]),[n,D]=l.useState({}),[p,f]=l.useState(""),[x,F]=l.useState(!1),K=l.useMemo(()=>e.jsx(u,{gap:"xs",children:e.jsx(S,{color:x?"green":"red",icon:e.jsx(M,{}),title:x?t._({id:"fLe7w+"}):t._({id:"oBCe/M"}),children:e.jsx(_,{children:x?t._({id:"th4roR"}):t._({id:"WPCUXx"})})})}),[x]),O=l.useCallback(s=>!m.isSuperuser()||!o.plugins_enabled?[]:[{hidden:s.is_mandatory!=!1||s.active!=!0,title:t._({id:"5y3O+A"}),color:"red",icon:e.jsx(A,{}),onClick:()=>{f(s.key),F(!1),v.open()}},{hidden:s.is_mandatory!=!1||!s.is_installed||s.active!=!1,title:t._({id:"FQBaXG"}),tooltip:t._({id:"RqdYGI"}),color:"green",icon:e.jsx(M,{}),onClick:()=>{f(s.key),F(!0),v.open()}},{hidden:!s.active||!s.is_package||!s.package_name,title:t._({id:"EkH9pt"}),tooltip:t._({id:"R7mVjI"}),color:"blue",icon:e.jsx(L,{}),onClick:()=>{B(s.package_name),y.open()}},{hidden:!m.isSuperuser()||s.active||s.is_builtin||s.is_mandatory||s.is_sample||!s.is_installed||!s.is_package,title:t._({id:"fo0VXg"}),tooltip:t._({id:"ll8AEP"}),color:"red",icon:e.jsx(A,{}),onClick:()=>{f(s.key),T.open()}},{hidden:s.active||s.is_builtin||s.is_mandatory||s.is_sample||s.is_installed||!m.isSuperuser(),title:t._({id:"cnGeoo"}),tooltip:t._({id:"yX/BXa"}),color:"red",icon:e.jsx(H,{}),onClick:()=>{f(s.key),E.open()}}],[m,o]),[R,B]=l.useState(""),v=w({title:t._({id:"2RHgaV"}),url:c.plugin_activate,pathParams:{key:p},preFormContent:K,fetchInitialData:!1,method:"PATCH",successMessage:x?t._({id:"VAuM5b"}):t._({id:"ysKQPq"}),fields:{active:{hidden:!0}},initialData:{active:x},table:i}),y=le({title:t._({id:"0O/OZv"}),url:c.plugin_install,timeout:3e4,fields:{packagename:{},url:{},version:{},confirm:{}},initialData:{packagename:R},closeOnClickOutside:!1,submitText:t._({id:"TKQ7K+"}),successMessage:t._({id:"MiYlP5"}),table:i}),T=w({title:t._({id:"mXzRzO"}),url:c.plugin_uninstall,pathParams:{key:p},fetchInitialData:!1,timeout:3e4,fields:{delete_config:{}},preFormContent:e.jsx(S,{color:"red",icon:e.jsx(N,{}),title:t._({id:"6onEou"}),children:e.jsxs(u,{gap:"xs",children:[e.jsx(_,{children:t._({id:"nh4MTY"})}),e.jsx(_,{children:t._({id:"U99rVM"})})]})}),successMessage:t._({id:"MAZU/W"}),table:i}),E=oe({url:c.plugin_list,pk:p,fetchInitialData:!1,title:t._({id:"nud26y"}),preFormWarning:t._({id:"vb5uIh"}),table:i}),W=l.useCallback(()=>{a.post(V(c.plugin_reload),{full_reload:!0,force_reload:!0,collect_plugins:!0}).then(()=>{X({title:t._({id:"Bs76+T"}),message:t._({id:"js1VzJ"}),color:"green"}),i.refreshTable()})},[]),Y=l.useMemo(()=>!m.isSuperuser()||!o.plugins_enabled?[]:[e.jsx(g,{color:"green",icon:e.jsx(L,{}),tooltip:t._({id:"2VWTDu"}),onClick:W},"reload"),e.jsx(g,{color:"green",icon:e.jsx(J,{}),tooltip:t._({id:"0O/OZv"}),onClick:()=>{B(""),y.open()},disabled:o.plugins_install_disabled||!1},"install")],[m,o]);return e.jsxs(e.Fragment,{children:[y.modal,T.modal,E.modal,v.modal,e.jsx(q,{title:`${t._({id:"NCjc4L"})} - ${n==null?void 0:n.name}`,size:"65%",renderContent:s=>{if(s)return e.jsx(ne,{pluginKey:s,pluginInstance:n})}}),e.jsx(de,{url:V(c.plugin_list),tableState:i,columns:b,props:{enableDownload:!1,rowActions:O,onRowClick:s=>{D(s),j(`${s.key}/`)},tableActions:Y,tableFilters:[{name:"active",label:t._({id:"F6pfE9"}),type:"boolean"},{name:"builtin",label:t._({id:"++LBSt"}),type:"boolean"},{name:"mandatory",label:t._({id:"gFFgtV"}),type:"boolean"},{name:"sample",label:t._({id:"LcJmOR"}),type:"boolean"},{name:"installed",label:t._({id:"eQkgKV"}),type:"boolean"}]}})]})}export{Ee as default};
//# sourceMappingURL=PluginListTable-DUvPvxn9.js.map
