{"version":3,"file":"PartCategoryTemplateTable-CbPoE-oE.js","sources":["../../../../../../frontend/src/tables/part/PartCategoryTemplateTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Group, Text } from '@mantine/core';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\nimport type { TableColumn } from '@lib/types/Tables';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\nexport default function PartCategoryTemplateTable() {\n  const table = useTable('part-category-parameter-templates');\n  const user = useUserState();\n\n  const formFields: ApiFormFieldSet = useMemo(() => {\n    return {\n      category: {},\n      parameter_template: {},\n      default_value: {}\n    };\n  }, []);\n\n  const [selectedTemplate, setSelectedTemplate] = useState<number>(0);\n\n  const newTemplate = useCreateApiFormModal({\n    url: ApiEndpoints.category_parameter_list,\n    title: t`Add Category Parameter`,\n    fields: useMemo(() => ({ ...formFields }), [formFields]),\n    table: table\n  });\n\n  const editTemplate = useEditApiFormModal({\n    url: ApiEndpoints.category_parameter_list,\n    pk: selectedTemplate,\n    title: t`Edit Category Parameter`,\n    fields: useMemo(() => ({ ...formFields }), [formFields]),\n    table: table\n  });\n\n  const deleteTemplate = useDeleteApiFormModal({\n    url: ApiEndpoints.category_parameter_list,\n    pk: selectedTemplate,\n    title: t`Delete Category Parameter`,\n    table: table\n  });\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    // TODO\n    return [];\n  }, []);\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'category_detail.name',\n        title: t`Category`,\n        sortable: true,\n        switchable: false\n      },\n      {\n        accessor: 'category_detail.pathstring'\n      },\n      {\n        accessor: 'parameter_template_detail.name',\n        title: t`Parameter Template`,\n        sortable: true,\n        switchable: false\n      },\n      {\n        accessor: 'default_value',\n        sortable: true,\n        switchable: false,\n        render: (record: any) => {\n          if (!record?.default_value) {\n            return '-';\n          }\n\n          let units = '';\n\n          if (record?.parameter_template_detail?.units) {\n            units = `[${record.parameter_template_detail.units}]`;\n          }\n\n          return (\n            <Group justify='space-between' grow>\n              <Text>{record.default_value}</Text>\n              {units && <Text size='xs'>{units}</Text>}\n            </Group>\n          );\n        }\n      }\n    ];\n  }, []);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.part),\n          onClick: () => {\n            setSelectedTemplate(record.pk);\n            editTemplate.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.part),\n          onClick: () => {\n            setSelectedTemplate(record.pk);\n            deleteTemplate.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add'\n        tooltip={t`Add Category Parameter`}\n        onClick={() => newTemplate.open()}\n        hidden={!user.hasAddRole(UserRoles.part)}\n      />\n    ];\n  }, [user]);\n\n  return (\n    <>\n      {newTemplate.modal}\n      {editTemplate.modal}\n      {deleteTemplate.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.category_parameter_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          rowActions: rowActions,\n          tableFilters: tableFilters,\n          tableActions: tableActions,\n          enableDownload: true\n        }}\n      />\n    </>\n  );\n}\n"],"names":["PartCategoryTemplateTable","table","useTable","user","useUserState","formFields","useMemo","category","parameter_template","default_value","selectedTemplate","setSelectedTemplate","useState","newTemplate","useCreateApiFormModal","url","ApiEndpoints","category_parameter_list","title","_i18n","_","id","fields","editTemplate","useEditApiFormModal","pk","deleteTemplate","useDeleteApiFormModal","tableFilters","tableColumns","accessor","sortable","switchable","render","record","units","parameter_template_detail","jsxs","Group","jsx","Text","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","UserRoles","part","onClick","open","RowDeleteAction","hasDeleteRole","tableActions","AddItemButton","hasAddRole","Fragment","modal","InvenTreeTable","apiUrl","enableDownload"],"mappings":"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"}
