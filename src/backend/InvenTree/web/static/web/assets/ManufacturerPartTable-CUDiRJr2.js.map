{"version":3,"file":"ManufacturerPartTable-CUDiRJr2.js","sources":["../../../../../../frontend/src/tables/purchasing/ManufacturerPartTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { useManufacturerPartFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CompanyColumn,\n  DescriptionColumn,\n  LinkColumn,\n  PartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/*\n * Construct a table listing manufacturer parts\n */\nexport function ManufacturerPartTable({\n  params\n}: Readonly<{ params: any }>): ReactNode {\n  const table = useTable('manufacturerparts');\n\n  const user = useUserState();\n\n  // Construct table columns for this table\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      PartColumn({\n        switchable: 'part' in params\n      }),\n      {\n        accessor: 'manufacturer',\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record?.manufacturer_detail} />\n        )\n      },\n      {\n        accessor: 'MPN',\n        title: t`MPN`,\n        sortable: true\n      },\n      DescriptionColumn({}),\n      LinkColumn({})\n    ];\n  }, [params]);\n\n  const manufacturerPartFields = useManufacturerPartFields();\n\n  const [selectedPart, setSelectedPart] = useState<number | undefined>(\n    undefined\n  );\n\n  const createManufacturerPart = useCreateApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    title: t`Add Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table,\n    initialData: {\n      manufacturer: params?.manufacturer,\n      part: params?.part\n    }\n  });\n\n  const editManufacturerPart = useEditApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Edit Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table\n  });\n\n  const deleteManufacturerPart = useDeleteApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Delete Manufacturer Part`,\n    table: table\n  });\n\n  const tableActions = useMemo(() => {\n    const can_add =\n      user.hasAddRole(UserRoles.purchase_order) &&\n      user.hasAddRole(UserRoles.part);\n\n    return [\n      <AddItemButton\n        key='add-manufacturer-part'\n        tooltip={t`Add Manufacturer Part`}\n        onClick={() => createManufacturerPart.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            editManufacturerPart.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            deleteManufacturerPart.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {createManufacturerPart.modal}\n      {editManufacturerPart.modal}\n      {deleteManufacturerPart.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.manufacturer_part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          params: {\n            ...params,\n            part_detail: true,\n            manufacturer_detail: true\n          },\n          enableDownload: true,\n          rowActions: rowActions,\n          tableActions: tableActions,\n          modelType: ModelType.manufacturerpart\n        }}\n      />\n    </>\n  );\n}\n"],"names":["ManufacturerPartTable","params","table","useTable","user","useUserState","tableColumns","useMemo","PartColumn","switchable","accessor","sortable","render","record","CompanyColumn","manufacturer_detail","title","_i18n","_","id","DescriptionColumn","LinkColumn","manufacturerPartFields","useManufacturerPartFields","selectedPart","setSelectedPart","useState","undefined","createManufacturerPart","useCreateApiFormModal","url","ApiEndpoints","manufacturer_part_list","fields","initialData","manufacturer","part","editManufacturerPart","useEditApiFormModal","pk","deleteManufacturerPart","useDeleteApiFormModal","tableActions","can_add","hasAddRole","UserRoles","purchase_order","jsx","AddItemButton","open","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","RowDeleteAction","hasDeleteRole","jsxs","Fragment","modal","InvenTreeTable","apiUrl","part_detail","enableDownload","modelType","ModelType","manufacturerpart"],"mappings":"iXAiCO,SAASA,EAAsB,CACpCC,OAAAA,CACyB,EAAc,CACvC,MAAMC,EAAQC,EAAS,mBAAmB,EAEpCC,EAAOC,EAAAA,EAGPC,EAA8BC,EAAAA,QAAQ,IACnC,CACLC,EAAW,CACTC,WAAY,SAAUR,CAAAA,CACvB,EACD,CACES,SAAU,eACVC,SAAU,GACVC,OAASC,SACNC,EAAA,CAAc,QAASD,GAAAA,YAAAA,EAAQE,mBAAAA,CAAoB,CAAA,EAGxD,CACEL,SAAU,MACVM,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAK,EACZR,SAAU,EAAA,EAEZS,EAAkB,CAAA,CAAE,EACpBC,EAAW,CAAA,CAAE,CAAC,EAEf,CAACpB,CAAM,CAAC,EAELqB,EAAyBC,EAAAA,EAEzB,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SACtCC,MACF,EAEMC,EAAyBC,EAAsB,CACnDC,IAAKC,EAAaC,uBAClBhB,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAuB,EAC9Bc,OAAQX,EACRpB,MAAAA,EACAgC,YAAa,CACXC,aAAclC,GAAAA,YAAAA,EAAQkC,aACtBC,KAAMnC,GAAAA,YAAAA,EAAQmC,IAAAA,CAChB,CACD,EAEKC,EAAuBC,EAAoB,CAC/CR,IAAKC,EAAaC,uBAClBO,GAAIf,EACJR,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAwB,EAC/Bc,OAAQX,EACRpB,MAAAA,CAAAA,CACD,EAEKsC,EAAyBC,EAAsB,CACnDX,IAAKC,EAAaC,uBAClBO,GAAIf,EACJR,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAA0B,EACjCjB,MAAAA,CAAAA,CACD,EAEKwC,EAAenC,EAAAA,QAAQ,IAAM,CACjC,MAAMoC,EACJvC,EAAKwC,WAAWC,EAAUC,cAAc,GACxC1C,EAAKwC,WAAWC,EAAUT,IAAI,EAEhC,MAAO,CACLW,EAAAA,IAACC,EAAA,CAEC,QAAQ/B,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAuB,EAChC,QAAS,IAAMS,EAAuBqB,KAAAA,EACtC,OAAQ,CAACN,GAHL,wBAIJ,CAEN,EAAG,CAACvC,CAAI,CAAC,EAEH8C,EAAaC,cAChBtC,GACQ,CACLuC,EAAc,CACZC,OAAQ,CAACjD,EAAKkD,cAAcT,EAAUC,cAAc,EACpDS,QAASA,IAAM,CACb9B,EAAgBZ,EAAO0B,EAAE,EACzBF,EAAqBY,KAAAA,CACvB,CAAA,CACD,EACDO,EAAgB,CACdH,OAAQ,CAACjD,EAAKqD,cAAcZ,EAAUC,cAAc,EACpDS,QAASA,IAAM,CACb9B,EAAgBZ,EAAO0B,EAAE,EACzBC,EAAuBS,KAAAA,CACzB,CAAA,CACD,CAAC,EAGN,CAAC7C,CAAI,CACP,EAEA,OACEsD,EAAAA,KAAAC,WAAA,CACG/B,SAAAA,CAAAA,EAAuBgC,MACvBvB,EAAqBuB,MACrBpB,EAAuBoB,MACxBb,EAAAA,IAACc,EAAA,CACC,IAAKC,EAAO/B,EAAaC,sBAAsB,EAC/C,WAAY9B,EACZ,QAASI,EACT,MAAO,CACLL,OAAQ,CACN,GAAGA,EACH8D,YAAa,GACbhD,oBAAqB,EAAA,EAEvBiD,eAAgB,GAChBd,WAAAA,EACAR,aAAAA,EACAuB,UAAWC,EAAUC,gBAAAA,CACvB,CAAE,CAAA,EAEN,CAEJ"}
