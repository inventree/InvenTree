{"version":3,"file":"SalesOrderDetail-Dp9R7fUL.js","sources":["../../../../../../frontend/src/tables/sales/SalesOrderLineItemTable.tsx","../../../../../../frontend/src/tables/sales/SalesOrderShipmentTable.tsx","../../../../../../frontend/src/tables/sales/TaxExtraLineItemTable.tsx","../../../../../../frontend/src/pages/sales/SalesOrderDetail.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Group, Paper, Text } from '@mantine/core';\nimport {\n  IconArrowRight,\n  IconHash,\n  IconShoppingCart,\n  IconSquareArrowRight,\n  IconTools\n} from '@tabler/icons-react';\nimport type { DataTableRowExpansionProps } from 'mantine-datatable';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { ProgressBar } from '@lib/components/ProgressBar';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowDuplicateAction,\n  RowEditAction,\n  RowViewAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { RenderPart } from '../../components/render/Part';\nimport OrderPartsWizard from '../../components/wizards/OrderPartsWizard';\nimport { formatCurrency, formatDecimal } from '../../defaults/formatters';\nimport { useBuildOrderFields } from '../../forms/BuildForms';\nimport {\n  useAllocateToSalesOrderForm,\n  useSalesOrderAllocateSerialsFields,\n  useSalesOrderLineItemFields\n} from '../../forms/SalesOrderForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CurrencyColumn,\n  DateColumn,\n  DecimalColumn,\n  DescriptionColumn,\n  LinkColumn,\n  PercentageColumn,\n  RenderPartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\nimport RowExpansionIcon from '../RowExpansionIcon';\nimport { TableHoverCard } from '../TableHoverCard';\nimport SalesOrderAllocationTable from './SalesOrderAllocationTable';\n\nexport default function SalesOrderLineItemTable({\n  orderId,\n  orderDetailRefresh,\n  currency,\n  customerId,\n  editable\n}: Readonly<{\n  orderId: number;\n  orderDetailRefresh: () => void;\n  currency: string;\n  customerId: number;\n  editable: boolean;\n}>) {\n  const navigate = useNavigate();\n  const user = useUserState();\n  const table = useTable('sales-order-line-item');\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'part',\n        sortable: true,\n        switchable: false,\n        minWidth: 175,\n        render: (record: any) => {\n          return (\n            <Group wrap='nowrap'>\n              {record.part_detail?.virtual || (\n                <RowExpansionIcon\n                  enabled={record.allocated}\n                  expanded={table.isRowExpanded(record.pk)}\n                />\n              )}\n              <RenderPartColumn part={record.part_detail} />\n            </Group>\n          );\n        }\n      },\n      {\n        accessor: 'part_detail.IPN',\n        title: t`IPN`,\n        switchable: true\n      },\n      DescriptionColumn({\n        accessor: 'part_detail.description'\n      }),\n      {\n        accessor: 'reference',\n        sortable: false,\n        switchable: true\n      },\n      DecimalColumn({\n        accessor: 'quantity',\n        sortable: true\n      }),\n      {\n        accessor: 'sale_price',\n        render: (record: any) =>\n          formatCurrency(record.sale_price, {\n            currency: record.sale_price_currency\n          })\n      },\n      {\n        accessor: 'total_price',\n        title: t`Total Price`,\n        render: (record: any) =>\n          formatCurrency(record.sale_price, {\n            currency: record.sale_price_currency,\n            multiplier: record.quantity\n          })\n      },\n      CurrencyColumn({\n        accessor: 'price_with_tax',\n        title: t`Price with Tax`\n      }),\n      CurrencyColumn({\n        accessor: 'subtotal',\n        title: t`Subtotal`\n      }),\n      CurrencyColumn({\n        accessor: 'tax_amount',\n        title: t`Total Tax`\n      }),\n      CurrencyColumn({\n        accessor: 'total_with_tax',\n        title: t`Total with Tax`\n      }),\n      PercentageColumn({\n        accessor: 'tax_rate',\n        title: t`Tax Rate`,\n        sortable: true\n      }),\n      DateColumn({\n        accessor: 'target_date',\n        sortable: true,\n        title: t`Target Date`\n      }),\n      {\n        accessor: 'stock',\n        title: t`Available Stock`,\n        render: (record: any) => {\n          if (record.part_detail?.virtual) {\n            return <Text size='sm' fs='italic'>{t`Virtual part`}</Text>;\n          }\n\n          const part_stock = record?.available_stock ?? 0;\n          const variant_stock = record?.available_variant_stock ?? 0;\n          const available = part_stock + variant_stock;\n\n          const required = Math.max(\n            record.quantity - record.allocated - record.shipped,\n            0\n          );\n\n          let color: string | undefined;\n          let text = `${formatDecimal(available)}`;\n\n          const extra: ReactNode[] = [];\n\n          if (available <= 0) {\n            color = 'red';\n            text = t`No stock available`;\n          } else if (available < required) {\n            color = 'orange';\n          }\n\n          if (variant_stock > 0) {\n            extra.push(<Text size='sm'>{t`Includes variant stock`}</Text>);\n          }\n\n          if (record.building > 0) {\n            extra.push(\n              <Text size='sm'>\n                {t`In production`}: {formatDecimal(record.building)}\n              </Text>\n            );\n          }\n\n          if (record.on_order > 0) {\n            extra.push(\n              <Text size='sm'>\n                {t`On order`}: {formatDecimal(record.on_order)}\n              </Text>\n            );\n          }\n\n          return (\n            <TableHoverCard\n              value={<Text c={color}>{text}</Text>}\n              extra={extra}\n              title={t`Stock Information`}\n            />\n          );\n        }\n      },\n      {\n        accessor: 'allocated',\n        sortable: true,\n        render: (record: any) => {\n          if (record.part_detail?.virtual) {\n            return <Text size='sm' fs='italic'>{t`Virtual part`}</Text>;\n          }\n\n          return (\n            <ProgressBar\n              progressLabel={true}\n              value={record.allocated}\n              maximum={record.quantity}\n            />\n          );\n        }\n      },\n      {\n        accessor: 'shipped',\n        sortable: true,\n        render: (record: any) => {\n          if (record.part_detail?.virtual) {\n            return <Text size='sm' fs='italic'>{t`Virtual part`}</Text>;\n          }\n\n          return (\n            <ProgressBar\n              progressLabel={true}\n              value={record.shipped}\n              maximum={record.quantity}\n            />\n          );\n        }\n      },\n      {\n        accessor: 'notes'\n      },\n      LinkColumn({\n        accessor: 'link'\n      })\n    ];\n  }, [table.isRowExpanded]);\n\n  const [selectedLineId, setSelectedLineId] = useState<number>(0);\n\n  const [selectedSupplierPart, setSelectedSupplierPart] = useState<any>(null);\n\n  const [initialData, setInitialData] = useState({});\n\n  const createLineFields = useSalesOrderLineItemFields({\n    orderId: orderId,\n    customerId: customerId,\n    create: true,\n    currency: currency\n  });\n\n  const newLine = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_line_list,\n    title: t`Add Line Item`,\n    fields: createLineFields,\n    initialData: {\n      ...initialData,\n      sale_price_currency: currency\n    },\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const editLineFields = useSalesOrderLineItemFields({\n    orderId: orderId,\n    customerId: customerId,\n    create: false\n  });\n\n  const editLine = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_line_list,\n    pk: selectedLineId,\n    title: t`Edit Line Item`,\n    fields: editLineFields,\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const deleteLine = useDeleteApiFormModal({\n    url: ApiEndpoints.sales_order_line_list,\n    pk: selectedLineId,\n    title: t`Delete Line Item`,\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const allocateSerialFields = useSalesOrderAllocateSerialsFields({\n    itemId: selectedLineId,\n    orderId: orderId\n  });\n\n  const allocateBySerials = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_allocate_serials,\n    pk: orderId,\n    title: t`Allocate Serial Numbers`,\n    preFormContent: selectedSupplierPart ? (\n      <Paper withBorder p='sm'>\n        <RenderPart instance={selectedSupplierPart} />\n      </Paper>\n    ) : undefined,\n    initialData: initialData,\n    fields: allocateSerialFields,\n    table: table\n  });\n\n  const buildOrderFields = useBuildOrderFields({\n    create: true,\n    modalId: 'build-order-create-from-sales-order'\n  });\n\n  const newBuildOrder = useCreateApiFormModal({\n    url: ApiEndpoints.build_order_list,\n    title: t`Create Build Order`,\n    modalId: 'build-order-create-from-sales-order',\n    fields: buildOrderFields,\n    initialData: initialData,\n    follow: true,\n    modelType: ModelType.build\n  });\n\n  const [selectedItems, setSelectedItems] = useState<any[]>([]);\n\n  const allocateStock = useAllocateToSalesOrderForm({\n    orderId: orderId,\n    lineItems: selectedItems,\n    onFormSuccess: () => {\n      table.refreshTable();\n      table.clearSelectedRecords();\n    }\n  });\n\n  const [partsToOrder, setPartsToOrder] = useState<any[]>([]);\n\n  const orderPartsWizard = OrderPartsWizard({\n    parts: partsToOrder\n  });\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'allocated',\n        label: t`Allocated`,\n        description: t`Show lines which are fully allocated`\n      },\n      {\n        name: 'completed',\n        label: t`Completed`,\n        description: t`Show lines which are completed`\n      }\n    ];\n  }, []);\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add-line-item'\n        tooltip={t`Add Line Item`}\n        onClick={() => {\n          setInitialData({\n            order: orderId\n          });\n          newLine.open();\n        }}\n        hidden={!editable || !user.hasAddRole(UserRoles.sales_order)}\n      />,\n      <ActionButton\n        key='order-parts'\n        hidden={!user.hasAddRole(UserRoles.purchase_order)}\n        disabled={!table.hasSelectedRecords}\n        tooltip={t`Order Parts`}\n        icon={<IconShoppingCart />}\n        color='blue'\n        onClick={() => {\n          setPartsToOrder(table.selectedRecords.map((r) => r.part_detail));\n          orderPartsWizard.openWizard();\n        }}\n      />,\n      <ActionButton\n        key='allocate-stock'\n        tooltip={t`Allocate Stock`}\n        icon={<IconArrowRight />}\n        disabled={!table.hasSelectedRecords}\n        color='green'\n        onClick={() => {\n          setSelectedItems(\n            table.selectedRecords.filter((r) => r.allocated < r.quantity)\n          );\n          allocateStock.open();\n        }}\n      />\n    ];\n  }, [user, orderId, table.hasSelectedRecords, table.selectedRecords]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      const allocated = (record?.allocated ?? 0) > (record?.quantity ?? 0);\n      const virtual = record?.part_detail?.virtual ?? false;\n\n      return [\n        RowViewAction({\n          title: t`View Part`,\n          modelType: ModelType.part,\n          modelId: record.part,\n          navigate: navigate,\n          hidden: !user.hasViewRole(UserRoles.part)\n        }),\n        {\n          hidden:\n            allocated ||\n            virtual ||\n            !editable ||\n            !user.hasChangeRole(UserRoles.sales_order),\n          title: t`Allocate Stock`,\n          icon: <IconSquareArrowRight />,\n          color: 'green',\n          onClick: () => {\n            setSelectedItems([record]);\n            allocateStock.open();\n          }\n        },\n        {\n          hidden:\n            !record?.part_detail?.trackable ||\n            allocated ||\n            virtual ||\n            !editable ||\n            !user.hasChangeRole(UserRoles.sales_order),\n          title: t`Allocate serials`,\n          icon: <IconHash />,\n          color: 'green',\n          onClick: () => {\n            setSelectedLineId(record.pk);\n            setSelectedSupplierPart(record?.part_detail ?? null);\n            setInitialData({\n              quantity: record.quantity - record.allocated\n            });\n            allocateBySerials.open();\n          }\n        },\n        {\n          hidden:\n            allocated ||\n            virtual ||\n            !user.hasAddRole(UserRoles.build) ||\n            !record?.part_detail?.assembly,\n          title: t`Build stock`,\n          icon: <IconTools />,\n          color: 'blue',\n          onClick: () => {\n            setInitialData({\n              part: record.part,\n              quantity: (record?.quantity ?? 1) - (record?.allocated ?? 0),\n              sales_order: orderId\n            });\n            newBuildOrder.open();\n          }\n        },\n        {\n          hidden:\n            allocated ||\n            virtual ||\n            !user.hasAddRole(UserRoles.purchase_order) ||\n            !record?.part_detail?.purchaseable,\n          title: t`Order stock`,\n          icon: <IconShoppingCart />,\n          color: 'blue',\n          onClick: () => {\n            setPartsToOrder([record.part_detail]);\n            orderPartsWizard.openWizard();\n          }\n        },\n        RowEditAction({\n          hidden: !editable || !user.hasChangeRole(UserRoles.sales_order),\n          onClick: () => {\n            setSelectedLineId(record.pk);\n            editLine.open();\n          }\n        }),\n        RowDuplicateAction({\n          hidden: !editable || !user.hasAddRole(UserRoles.sales_order),\n          onClick: () => {\n            setInitialData(record);\n            newLine.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !editable || !user.hasDeleteRole(UserRoles.sales_order),\n          onClick: () => {\n            setSelectedLineId(record.pk);\n            deleteLine.open();\n          }\n        })\n      ];\n    },\n    [navigate, user, editable]\n  );\n\n  // Control row expansion\n  const rowExpansion: DataTableRowExpansionProps<any> = useMemo(() => {\n    return {\n      allowMultiple: true,\n      expandable: ({ record }: { record: any }) => {\n        if (record?.part_detail?.virtual) {\n          return false;\n        }\n        return table.isRowExpanded(record.pk) || record.allocated > 0;\n      },\n      content: ({ record }: { record: any }) => {\n        return (\n          <SalesOrderAllocationTable\n            showOrderInfo={false}\n            showPartInfo={false}\n            orderId={orderId}\n            lineItemId={record.pk}\n            partId={record.part}\n            allowEdit={true}\n            modelTarget={ModelType.stockitem}\n            modelField={'item'}\n            isSubTable\n          />\n        );\n      }\n    };\n  }, [orderId, table.isRowExpanded]);\n\n  return (\n    <>\n      {editLine.modal}\n      {deleteLine.modal}\n      {newLine.modal}\n      {newBuildOrder.modal}\n      {allocateBySerials.modal}\n      {allocateStock.modal}\n      {orderPartsWizard.wizard}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.sales_order_line_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          enableSelection: true,\n          enableDownload: true,\n          params: {\n            order: orderId,\n            part_detail: true\n          },\n          rowActions: rowActions,\n          tableActions: tableActions,\n          tableFilters: tableFilters,\n          rowExpansion: rowExpansion\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { IconTruckDelivery } from '@tabler/icons-react';\nimport { useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowCancelAction,\n  RowEditAction,\n  RowViewAction\n} from '@lib/components/RowActions';\nimport { YesNoButton } from '@lib/components/YesNoButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport dayjs from 'dayjs';\nimport {\n  useSalesOrderShipmentCompleteFields,\n  useSalesOrderShipmentFields\n} from '../../forms/SalesOrderForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { DateColumn, LinkColumn } from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\nexport default function SalesOrderShipmentTable({\n  orderId\n}: Readonly<{\n  orderId: number;\n}>) {\n  const user = useUserState();\n  const navigate = useNavigate();\n  const table = useTable('sales-order-shipment');\n\n  const [selectedShipment, setSelectedShipment] = useState<any>({});\n\n  const newShipmentFields = useSalesOrderShipmentFields({});\n\n  const editShipmentFields = useSalesOrderShipmentFields({});\n\n  const completeShipmentFields = useSalesOrderShipmentCompleteFields({});\n\n  const newShipment = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    fields: newShipmentFields,\n    title: t`Create Shipment`,\n    table: table,\n    initialData: {\n      order: orderId\n    }\n  });\n\n  const deleteShipment = useDeleteApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: selectedShipment.pk,\n    title: t`Cancel Shipment`,\n    table: table\n  });\n\n  const editShipment = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: selectedShipment.pk,\n    fields: editShipmentFields,\n    title: t`Edit Shipment`,\n    table: table\n  });\n\n  const completeShipment = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_complete,\n    pk: selectedShipment.pk,\n    fields: completeShipmentFields,\n    title: t`Complete Shipment`,\n    table: table,\n    focus: 'tracking_number',\n    initialData: {\n      ...selectedShipment,\n      shipment_date: dayjs().format('YYYY-MM-DD')\n    }\n  });\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'reference',\n        title: t`Shipment Reference`,\n        switchable: false,\n        sortable: true\n      },\n      {\n        accessor: 'allocated_items',\n        sortable: true,\n        switchable: false,\n        title: t`Items`\n      },\n      {\n        accessor: 'shipped',\n        title: t`Shipped`,\n        switchable: true,\n        sortable: false,\n        render: (record: any) => <YesNoButton value={!!record.shipment_date} />\n      },\n      DateColumn({\n        accessor: 'shipment_date',\n        title: t`Shipment Date`\n      }),\n      DateColumn({\n        accessor: 'delivery_date',\n        title: t`Delivery Date`\n      }),\n      {\n        accessor: 'tracking_number'\n      },\n      {\n        accessor: 'invoice_number'\n      },\n      LinkColumn({\n        accessor: 'link'\n      })\n    ];\n  }, []);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      const shipped: boolean = !!record.shipment_date;\n\n      return [\n        RowViewAction({\n          title: t`View Shipment`,\n          modelType: ModelType.salesordershipment,\n          modelId: record.pk,\n          navigate: navigate\n        }),\n        {\n          hidden: shipped || !user.hasChangeRole(UserRoles.sales_order),\n          title: t`Complete Shipment`,\n          color: 'green',\n          icon: <IconTruckDelivery />,\n          onClick: () => {\n            setSelectedShipment(record);\n            completeShipment.open();\n          }\n        },\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.sales_order),\n          tooltip: t`Edit shipment`,\n          onClick: () => {\n            setSelectedShipment(record);\n            editShipment.open();\n          }\n        }),\n        RowCancelAction({\n          hidden: shipped || !user.hasDeleteRole(UserRoles.sales_order),\n          tooltip: t`Cancel shipment`,\n          onClick: () => {\n            setSelectedShipment(record);\n            deleteShipment.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add-shipment'\n        tooltip={t`Add shipment`}\n        hidden={!user.hasAddRole(UserRoles.sales_order)}\n        onClick={() => {\n          newShipment.open();\n        }}\n      />\n    ];\n  }, [user]);\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'shipped',\n        label: t`Shipped`,\n        description: t`Show shipments which have been shipped`\n      },\n      {\n        name: 'delivered',\n        label: t`Delivered`,\n        description: t`Show shipments which have been delivered`\n      }\n    ];\n  }, []);\n\n  return (\n    <>\n      {newShipment.modal}\n      {editShipment.modal}\n      {deleteShipment.modal}\n      {completeShipment.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.sales_order_shipment_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          tableActions: tableActions,\n          tableFilters: tableFilters,\n          modelType: ModelType.salesordershipment,\n          enableSelection: true,\n          enableReports: true,\n          rowActions: rowActions,\n          params: {\n            order: orderId\n          }\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowDuplicateAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport type { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport type { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { formatCurrency } from '../../defaults/formatters';\nimport { taxExtraLineItemFields } from '../../forms/CommonForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CurrencyColumn,\n  DecimalColumn,\n  DescriptionColumn,\n  LinkColumn,\n  NoteColumn,\n  PercentageColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\nexport default function ExtraLineItemTable({\n  endpoint,\n  orderId,\n  orderDetailRefresh,\n  currency,\n  role\n}: Readonly<{\n  endpoint: ApiEndpoints;\n  orderId: number;\n  orderDetailRefresh: () => void;\n  currency: string;\n  role: UserRoles;\n}>) {\n  const table = useTable('extra-line-item');\n  const user = useUserState();\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'reference',\n        switchable: false\n      },\n      DescriptionColumn({}),\n      DecimalColumn({\n        accessor: 'quantity',\n        switchable: false\n      }),\n      {\n        accessor: 'price',\n        title: t`Unit Price`,\n        render: (record: any) =>\n          formatCurrency(record.price, {\n            currency: record.price_currency\n          })\n      },\n      {\n        accessor: 'total_price',\n        title: t`Total Price`,\n        render: (record: any) =>\n          formatCurrency(record.price, {\n            currency: record.price_currency,\n            multiplier: record.quantity\n          })\n      },\n      CurrencyColumn({\n        accessor: 'price_with_tax',\n        title: t`Price with Tax`\n      }),\n      CurrencyColumn({\n        accessor: 'subtotal',\n        title: t`Subtotal`\n      }),\n      CurrencyColumn({\n        accessor: 'tax_amount',\n        title: t`Total Tax`\n      }),\n      CurrencyColumn({\n        accessor: 'total_with_tax',\n        title: t`Total with Tax`\n      }),\n      PercentageColumn({\n        accessor: 'tax_rate',\n        title: t`Tax Rate`,\n        sortable: true\n      }),\n      NoteColumn({\n        accessor: 'notes'\n      }),\n      LinkColumn({\n        accessor: 'link'\n      })\n    ];\n  }, []);\n\n  const [initialData, setInitialData] = useState<any>({});\n\n  const [selectedLine, setSelectedLine] = useState<number>(0);\n\n  const newLineItem = useCreateApiFormModal({\n    url: endpoint,\n    title: t`Add Line Item`,\n    fields: taxExtraLineItemFields({ create: true }),\n    initialData: {\n      ...initialData,\n      price_currency: currency\n    },\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const editLineItem = useEditApiFormModal({\n    url: endpoint,\n    pk: selectedLine,\n    title: t`Edit Line Item`,\n    fields: taxExtraLineItemFields({ create: false }),\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const deleteLineItem = useDeleteApiFormModal({\n    url: endpoint,\n    pk: selectedLine,\n    title: t`Delete Line Item`,\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(role),\n          onClick: () => {\n            setSelectedLine(record.pk);\n            editLineItem.open();\n          }\n        }),\n        RowDuplicateAction({\n          hidden: !user.hasAddRole(role),\n          onClick: () => {\n            setInitialData({ ...record });\n            newLineItem.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(role),\n          onClick: () => {\n            setSelectedLine(record.pk);\n            deleteLineItem.open();\n          }\n        })\n      ];\n    },\n    [user, role]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add-line-item'\n        tooltip={t`Add Extra Line Item`}\n        hidden={!user.hasAddRole(role)}\n        onClick={() => {\n          setInitialData({\n            order: orderId\n          });\n          newLineItem.open();\n        }}\n      />\n    ];\n  }, [user, role]);\n\n  return (\n    <>\n      {newLineItem.modal}\n      {editLineItem.modal}\n      {deleteLineItem.modal}\n      <InvenTreeTable\n        tableState={table}\n        url={apiUrl(endpoint)}\n        columns={tableColumns}\n        props={{\n          params: {\n            order: orderId\n          },\n          rowActions: rowActions,\n          tableActions: tableActions\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Accordion, Grid, Skeleton, Stack } from '@mantine/core';\nimport {\n  IconBookmark,\n  IconInfoCircle,\n  IconList,\n  IconTools,\n  IconTruckDelivery\n} from '@tabler/icons-react';\nimport { type ReactNode, useMemo } from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport AdminButton from '../../components/buttons/AdminButton';\nimport PrimaryActionButton from '../../components/buttons/PrimaryActionButton';\nimport { PrintingActions } from '../../components/buttons/PrintingActions';\nimport {\n  type DetailsField,\n  DetailsTable\n} from '../../components/details/Details';\nimport { DetailsImage } from '../../components/details/DetailsImage';\nimport { ItemDetailsGrid } from '../../components/details/ItemDetails';\nimport {\n  BarcodeActionDropdown,\n  CancelItemAction,\n  DuplicateItemAction,\n  EditItemAction,\n  HoldItemAction,\n  OptionsActionDropdown\n} from '../../components/items/ActionDropdown';\nimport { StylishText } from '../../components/items/StylishText';\nimport InstanceDetail from '../../components/nav/InstanceDetail';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport AttachmentPanel from '../../components/panels/AttachmentPanel';\nimport NotesPanel from '../../components/panels/NotesPanel';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport { StatusRenderer } from '../../components/render/StatusRenderer';\nimport { formatCurrency, formatPercentage } from '../../defaults/formatters';\nimport { useSalesOrderFields } from '../../forms/SalesOrderForms';\nimport {\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport useStatusCodes from '../../hooks/UseStatusCodes';\nimport { useGlobalSettingsState } from '../../states/SettingsStates';\nimport { useUserState } from '../../states/UserState';\nimport { BuildOrderTable } from '../../tables/build/BuildOrderTable';\nimport SalesOrderAllocationTable from '../../tables/sales/SalesOrderAllocationTable';\nimport SalesOrderLineItemTable from '../../tables/sales/SalesOrderLineItemTable';\nimport SalesOrderShipmentTable from '../../tables/sales/SalesOrderShipmentTable';\nimport TaxExtraLineItemTable from '../../tables/sales/TaxExtraLineItemTable';\n\n/**\n * Detail page for a single SalesOrder\n */\nexport default function SalesOrderDetail() {\n  const { id } = useParams();\n\n  const user = useUserState();\n\n  const globalSettings = useGlobalSettingsState();\n\n  const {\n    instance: order,\n    instanceQuery,\n    refreshInstance\n  } = useInstance({\n    endpoint: ApiEndpoints.sales_order_list,\n    pk: id,\n    params: {\n      customer_detail: true\n    }\n  });\n\n  const orderCurrency = useMemo(() => {\n    return (\n      order.order_currency ||\n      order.customer_detail?.currency ||\n      globalSettings.getSetting('INVENTREE_DEFAULT_CURRENCY')\n    );\n  }, [order, globalSettings]);\n\n  const detailsPanel = useMemo(() => {\n    if (instanceQuery.isFetching) {\n      return <Skeleton />;\n    }\n\n    const tl: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'reference',\n        label: t`Reference`,\n        copy: true\n      },\n      {\n        type: 'text',\n        name: 'customer_reference',\n        label: t`Customer Reference`,\n        copy: true,\n        icon: 'reference',\n        hidden: !order.customer_reference\n      },\n      {\n        type: 'link',\n        name: 'customer',\n        icon: 'customers',\n        label: t`Customer`,\n        model: ModelType.company\n      },\n      {\n        type: 'text',\n        name: 'description',\n        label: t`Description`,\n        copy: true\n      },\n      {\n        type: 'status',\n        name: 'status',\n        label: t`Status`,\n        model: ModelType.salesorder\n      },\n      {\n        type: 'status',\n        name: 'status_custom_key',\n        label: t`Custom Status`,\n        model: ModelType.salesorder,\n        icon: 'status',\n        hidden:\n          !order.status_custom_key || order.status_custom_key == order.status\n      }\n    ];\n\n    const tr: DetailsField[] = [\n      {\n        type: 'progressbar',\n        name: 'completed',\n        icon: 'progress',\n        label: t`Completed Line Items`,\n        total: order.line_items,\n        progress: order.completed_lines,\n        hidden: !order.line_items\n      },\n      {\n        type: 'progressbar',\n        name: 'shipments',\n        icon: 'shipment',\n        label: t`Completed Shipments`,\n        total: order.shipments_count,\n        progress: order.completed_shipments_count,\n        hidden: !order.shipments_count\n      },\n      {\n        type: 'text',\n        name: 'currency',\n        label: t`Order Currency`,\n        value_formatter: () => orderCurrency\n      },\n      {\n        type: 'text',\n        name: 'total_price',\n        label: t`Total Cost`,\n        value_formatter: () => {\n          return formatCurrency(order?.total_price, {\n            currency: orderCurrency\n          });\n        }\n      },\n      {\n        type: 'text',\n        icon: 'percent',\n        name: 'tax_rate',\n        label: t`Tax Rate`,\n        value_formatter: () => {\n          return formatPercentage(order?.tax_rate);\n        }\n      },\n      {\n        type: 'text',\n        icon: 'currency',\n        name: 'subtotal',\n        label: t`Subtotal`,\n        value_formatter: () => {\n          return formatCurrency(order?.subtotal, {\n            currency: orderCurrency\n          });\n        }\n      },\n      {\n        type: 'text',\n        icon: 'currency',\n        name: 'tax_amount',\n        label: t`Total Tax Amount`,\n        value_formatter: () => {\n          return formatCurrency(order?.tax_amount, {\n            currency: orderCurrency\n          });\n        }\n      },\n      {\n        type: 'text',\n        icon: 'currency',\n        name: 'total_with_tax',\n        label: t`Total with Tax`,\n        value_formatter: () => {\n          return formatCurrency(order?.total_with_tax, {\n            currency: orderCurrency\n          });\n        }\n      }\n    ];\n\n    const bl: DetailsField[] = [\n      {\n        type: 'link',\n        external: true,\n        name: 'link',\n        label: t`Link`,\n        copy: true,\n        hidden: !order.link\n      },\n      {\n        type: 'text',\n        name: 'contact_detail.name',\n        label: t`Contact`,\n        icon: 'user',\n        copy: true,\n        hidden: !order.contact\n      },\n      {\n        type: 'text',\n        name: 'contact_detail.email',\n        label: t`Contact Email`,\n        icon: 'email',\n        copy: true,\n        hidden: !order.contact_detail?.email\n      },\n      {\n        type: 'text',\n        name: 'contact_detail.phone',\n        label: t`Contact Phone`,\n        icon: 'phone',\n        copy: true,\n        hidden: !order.contact_detail?.phone\n      },\n      {\n        type: 'text',\n        name: 'project_code_label',\n        label: t`Project Code`,\n        icon: 'reference',\n        copy: true,\n        hidden: !order.project_code\n      },\n      {\n        type: 'text',\n        name: 'tenant_detail.name',\n        label: t`Tenant`,\n        icon: 'sitemap',\n        copy: true,\n        hidden: !order.tenant\n      },\n      {\n        type: 'text',\n        name: 'responsible',\n        label: t`Responsible`,\n        badge: 'owner',\n        hidden: !order.responsible\n      }\n    ];\n\n    const br: DetailsField[] = [\n      {\n        type: 'date',\n        name: 'creation_date',\n        label: t`Creation Date`,\n        copy: true,\n        hidden: !order.creation_date\n      },\n      {\n        type: 'date',\n        name: 'issue_date',\n        label: t`Issue Date`,\n        icon: 'calendar',\n        copy: true,\n        hidden: !order.issue_date\n      },\n      {\n        type: 'date',\n        name: 'start_date',\n        label: t`Start Date`,\n        icon: 'calendar',\n        hidden: !order.start_date,\n        copy: true\n      },\n      {\n        type: 'date',\n        name: 'target_date',\n        label: t`Target Date`,\n        hidden: !order.target_date,\n        copy: true\n      },\n      {\n        type: 'date',\n        name: 'shipment_date',\n        label: t`Completion Date`,\n        hidden: !order.shipment_date,\n        copy: true\n      }\n    ];\n\n    return (\n      <ItemDetailsGrid>\n        <Grid grow>\n          <DetailsImage\n            appRole={UserRoles.purchase_order}\n            apiPath={ApiEndpoints.company_list}\n            src={order.customer_detail?.image}\n            pk={order.customer}\n          />\n          <Grid.Col span={{ base: 12, sm: 8 }}>\n            <DetailsTable fields={tl} item={order} />\n          </Grid.Col>\n        </Grid>\n        <DetailsTable fields={tr} item={order} />\n        <DetailsTable fields={bl} item={order} />\n        <DetailsTable fields={br} item={order} />\n      </ItemDetailsGrid>\n    );\n  }, [order, orderCurrency, instanceQuery]);\n\n  const soStatus = useStatusCodes({ modelType: ModelType.salesorder });\n\n  const salesOrderFields = useSalesOrderFields({});\n\n  const editSalesOrder = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_list,\n    pk: order.pk,\n    title: t`Edit Sales Order`,\n    fields: salesOrderFields,\n    onFormSuccess: () => {\n      refreshInstance();\n    }\n  });\n\n  const duplicateOrderFields = useSalesOrderFields({\n    duplicateOrderId: order.pk\n  });\n\n  const duplicateSalesOrderInitialData = useMemo(() => {\n    const data = { ...order };\n    // if we set the reference to null/undefined, it will be left blank in the form\n    // if we omit the reference altogether, it will be auto-generated via reference pattern\n    // from the OPTIONS response\n    delete data.reference;\n    return data;\n  }, [order]);\n\n  const duplicateSalesOrder = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_list,\n    title: t`Add Sales Order`,\n    fields: duplicateOrderFields,\n    initialData: duplicateSalesOrderInitialData,\n    follow: true,\n    modelType: ModelType.salesorder\n  });\n\n  const orderPanels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'detail',\n        label: t`Order Details`,\n        icon: <IconInfoCircle />,\n        content: detailsPanel\n      },\n      {\n        name: 'line-items',\n        label: t`Line Items`,\n        icon: <IconList />,\n        content: (\n          <Accordion\n            multiple={true}\n            defaultValue={['line-items', 'extra-items']}\n          >\n            <Accordion.Item value='line-items' key='lineitems'>\n              <Accordion.Control>\n                <StylishText size='lg'>{t`Line Items`}</StylishText>\n              </Accordion.Control>\n              <Accordion.Panel>\n                <SalesOrderLineItemTable\n                  orderId={order.pk}\n                  orderDetailRefresh={refreshInstance}\n                  currency={orderCurrency}\n                  customerId={order.customer}\n                  editable={\n                    order.status != soStatus.COMPLETE &&\n                    order.status != soStatus.CANCELLED\n                  }\n                />\n              </Accordion.Panel>\n            </Accordion.Item>\n            <Accordion.Item value='extra-items' key='extraitems'>\n              <Accordion.Control>\n                <StylishText size='lg'>{t`Extra Line Items`}</StylishText>\n              </Accordion.Control>\n              <Accordion.Panel>\n                <TaxExtraLineItemTable\n                  endpoint={ApiEndpoints.sales_order_extra_line_list}\n                  orderId={order.pk}\n                  orderDetailRefresh={refreshInstance}\n                  currency={orderCurrency}\n                  role={UserRoles.sales_order}\n                />\n              </Accordion.Panel>\n            </Accordion.Item>\n          </Accordion>\n        )\n      },\n      {\n        name: 'shipments',\n        label: t`Shipments`,\n        icon: <IconTruckDelivery />,\n        content: <SalesOrderShipmentTable orderId={order.pk} />\n      },\n      {\n        name: 'allocations',\n        label: t`Allocated Stock`,\n        icon: <IconBookmark />,\n        content: (\n          <SalesOrderAllocationTable\n            orderId={order.pk}\n            showPartInfo\n            allowEdit\n            modelField='item'\n            modelTarget={ModelType.stockitem}\n          />\n        )\n      },\n      {\n        name: 'build-orders',\n        label: t`Build Orders`,\n        icon: <IconTools />,\n        hidden: !user.hasViewRole(UserRoles.build),\n        content: order?.pk ? (\n          <BuildOrderTable salesOrderId={order.pk} />\n        ) : (\n          <Skeleton />\n        )\n      },\n      AttachmentPanel({\n        model_type: ModelType.salesorder,\n        model_id: order.pk\n      }),\n      NotesPanel({\n        model_type: ModelType.salesorder,\n        model_id: order.pk\n      })\n    ];\n  }, [order, id, user, soStatus, user]);\n\n  const issueOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.sales_order_issue, order.pk),\n    title: t`Issue Sales Order`,\n    onFormSuccess: refreshInstance,\n    preFormWarning: t`Issue this order`,\n    successMessage: t`Order issued`\n  });\n\n  const cancelOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.sales_order_cancel, order.pk),\n    title: t`Cancel Sales Order`,\n    onFormSuccess: refreshInstance,\n    preFormWarning: t`Cancel this order`,\n    successMessage: t`Order cancelled`\n  });\n\n  const holdOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.sales_order_hold, order.pk),\n    title: t`Hold Sales Order`,\n    onFormSuccess: refreshInstance,\n    preFormWarning: t`Place this order on hold`,\n    successMessage: t`Order placed on hold`\n  });\n\n  const shipOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.sales_order_complete, order.pk),\n    title: t`Ship Sales Order`,\n    onFormSuccess: refreshInstance,\n    preFormWarning: t`Ship this order?`,\n    successMessage: t`Order shipped`,\n    fields: {\n      accept_incomplete: {}\n    }\n  });\n\n  const completeOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.sales_order_complete, order.pk),\n    title: t`Complete Sales Order`,\n    onFormSuccess: refreshInstance,\n    preFormWarning: t`Mark this order as complete`,\n    successMessage: t`Order completed`,\n    fields: {\n      accept_incomplete: {}\n    }\n  });\n\n  const soActions = useMemo(() => {\n    const canEdit: boolean = user.hasChangeRole(UserRoles.sales_order);\n\n    const canIssue: boolean =\n      canEdit &&\n      (order.status == soStatus.PENDING || order.status == soStatus.ON_HOLD);\n\n    const canCancel: boolean =\n      canEdit &&\n      (order.status == soStatus.PENDING ||\n        order.status == soStatus.ON_HOLD ||\n        order.status == soStatus.IN_PROGRESS);\n\n    const canHold: boolean =\n      canEdit &&\n      (order.status == soStatus.PENDING ||\n        order.status == soStatus.IN_PROGRESS);\n\n    const autoComplete = globalSettings.isSet('SALESORDER_SHIP_COMPLETE');\n\n    const canShip: boolean =\n      !autoComplete && canEdit && order.status == soStatus.IN_PROGRESS;\n    const canComplete: boolean =\n      canEdit &&\n      (order.status == soStatus.SHIPPED ||\n        (autoComplete && order.status == soStatus.IN_PROGRESS));\n\n    return [\n      <PrimaryActionButton\n        title={t`Issue Order`}\n        icon='issue'\n        hidden={!canIssue}\n        color='blue'\n        onClick={issueOrder.open}\n      />,\n      <PrimaryActionButton\n        title={t`Ship Order`}\n        icon='deliver'\n        hidden={!canShip}\n        color='blue'\n        onClick={shipOrder.open}\n      />,\n      <PrimaryActionButton\n        title={t`Complete Order`}\n        icon='complete'\n        hidden={!canComplete}\n        color='green'\n        onClick={completeOrder.open}\n      />,\n      <AdminButton model={ModelType.salesorder} id={order.pk} />,\n      <BarcodeActionDropdown\n        model={ModelType.salesorder}\n        pk={order.pk}\n        hash={order?.barcode_hash}\n      />,\n      <PrintingActions\n        modelType={ModelType.salesorder}\n        items={[order.pk]}\n        enableReports\n      />,\n      <OptionsActionDropdown\n        tooltip={t`Order Actions`}\n        actions={[\n          EditItemAction({\n            hidden: !canEdit,\n            onClick: editSalesOrder.open,\n            tooltip: t`Edit order`\n          }),\n          DuplicateItemAction({\n            hidden: !user.hasAddRole(UserRoles.sales_order),\n            onClick: duplicateSalesOrder.open,\n            tooltip: t`Duplicate order`\n          }),\n          HoldItemAction({\n            tooltip: t`Hold order`,\n            hidden: !canHold,\n            onClick: holdOrder.open\n          }),\n          CancelItemAction({\n            tooltip: t`Cancel order`,\n            hidden: !canCancel,\n            onClick: cancelOrder.open\n          })\n        ]}\n      />\n    ];\n  }, [user, order, soStatus, globalSettings]);\n\n  const orderBadges: ReactNode[] = useMemo(() => {\n    return instanceQuery.isLoading\n      ? []\n      : [\n          <StatusRenderer\n            status={order.status_custom_key}\n            type={ModelType.salesorder}\n            options={{ size: 'lg' }}\n            key={order.pk}\n          />\n        ];\n  }, [order, instanceQuery]);\n\n  const subtitle: string = useMemo(() => {\n    let t = order.customer_detail?.name || '';\n\n    if (order.customer_reference) {\n      t += ` (${order.customer_reference})`;\n    }\n\n    return t;\n  }, [order]);\n\n  return (\n    <>\n      {issueOrder.modal}\n      {cancelOrder.modal}\n      {holdOrder.modal}\n      {shipOrder.modal}\n      {completeOrder.modal}\n      {editSalesOrder.modal}\n      {duplicateSalesOrder.modal}\n      <InstanceDetail\n        query={instanceQuery}\n        requiredRole={UserRoles.sales_order}\n      >\n        <Stack gap='xs'>\n          <PageDetail\n            title={`${t`Sales Order`}: ${order.reference}`}\n            subtitle={subtitle}\n            imageUrl={order.customer_detail?.image}\n            badges={orderBadges}\n            actions={soActions}\n            breadcrumbs={[{ name: t`Sales`, url: '/sales/' }]}\n            lastCrumb={[\n              { name: order.reference, url: `/sales/sales-order/${order.pk}` }\n            ]}\n            editAction={editSalesOrder.open}\n            editEnabled={user.hasChangePermission(ModelType.salesorder)}\n          />\n          <PanelGroup\n            pageKey='salesorder'\n            panels={orderPanels}\n            model={ModelType.salesorder}\n            reloadInstance={refreshInstance}\n            instance={order}\n            id={order.pk}\n          />\n        </Stack>\n      </InstanceDetail>\n    </>\n  );\n}\n"],"names":["SalesOrderLineItemTable","orderId","orderDetailRefresh","currency","customerId","editable","navigate","useNavigate","user","useUserState","table","useTable","tableColumns","useMemo","accessor","sortable","switchable","minWidth","render","record","jsxs","Group","part_detail","virtual","jsx","RowExpansionIcon","allocated","isRowExpanded","pk","RenderPartColumn","title","_i18n","_","id","DescriptionColumn","DecimalColumn","formatCurrency","sale_price","sale_price_currency","multiplier","quantity","CurrencyColumn","PercentageColumn","DateColumn","Text","part_stock","available_stock","variant_stock","available_variant_stock","available","required","Math","max","shipped","color","text","formatDecimal","extra","push","building","on_order","TableHoverCard","ProgressBar","LinkColumn","selectedLineId","setSelectedLineId","useState","selectedSupplierPart","setSelectedSupplierPart","initialData","setInitialData","createLineFields","useSalesOrderLineItemFields","create","newLine","useCreateApiFormModal","url","ApiEndpoints","sales_order_line_list","fields","onFormSuccess","editLineFields","editLine","useEditApiFormModal","deleteLine","useDeleteApiFormModal","allocateSerialFields","useSalesOrderAllocateSerialsFields","itemId","allocateBySerials","sales_order_allocate_serials","preFormContent","Paper","RenderPart","undefined","buildOrderFields","useBuildOrderFields","modalId","newBuildOrder","build_order_list","follow","modelType","ModelType","build","selectedItems","setSelectedItems","allocateStock","useAllocateToSalesOrderForm","lineItems","refreshTable","clearSelectedRecords","partsToOrder","setPartsToOrder","orderPartsWizard","OrderPartsWizard","parts","tableFilters","name","label","description","tableActions","AddItemButton","order","open","hasAddRole","UserRoles","sales_order","ActionButton","purchase_order","hasSelectedRecords","IconShoppingCart","selectedRecords","map","r","openWizard","IconArrowRight","filter","rowActions","useCallback","RowViewAction","part","modelId","hidden","hasViewRole","hasChangeRole","icon","IconSquareArrowRight","onClick","trackable","IconHash","assembly","IconTools","purchaseable","RowEditAction","RowDuplicateAction","RowDeleteAction","hasDeleteRole","rowExpansion","allowMultiple","expandable","content","SalesOrderAllocationTable","stockitem","Fragment","modal","wizard","InvenTreeTable","apiUrl","enableSelection","enableDownload","params","SalesOrderShipmentTable","selectedShipment","setSelectedShipment","newShipmentFields","useSalesOrderShipmentFields","editShipmentFields","completeShipmentFields","useSalesOrderShipmentCompleteFields","newShipment","sales_order_shipment_list","deleteShipment","editShipment","completeShipment","sales_order_shipment_complete","focus","shipment_date","dayjs","format","YesNoButton","salesordershipment","IconTruckDelivery","tooltip","RowCancelAction","enableReports","ExtraLineItemTable","endpoint","role","price","price_currency","NoteColumn","selectedLine","setSelectedLine","newLineItem","taxExtraLineItemFields","editLineItem","deleteLineItem","SalesOrderDetail","useParams","globalSettings","useGlobalSettingsState","instance","instanceQuery","refreshInstance","useInstance","sales_order_list","customer_detail","orderCurrency","order_currency","getSetting","detailsPanel","isFetching","Skeleton","tl","type","copy","customer_reference","model","company","salesorder","status_custom_key","status","tr","total","line_items","progress","completed_lines","shipments_count","completed_shipments_count","value_formatter","total_price","formatPercentage","tax_rate","subtotal","tax_amount","total_with_tax","bl","external","link","contact","contact_detail","email","phone","project_code","tenant","badge","responsible","br","creation_date","issue_date","start_date","target_date","ItemDetailsGrid","Grid","DetailsImage","company_list","image","customer","base","sm","DetailsTable","soStatus","useStatusCodes","salesOrderFields","useSalesOrderFields","editSalesOrder","duplicateOrderFields","duplicateOrderId","duplicateSalesOrderInitialData","data","reference","duplicateSalesOrder","orderPanels","IconInfoCircle","IconList","Accordion","StylishText","COMPLETE","CANCELLED","TaxExtraLineItemTable","sales_order_extra_line_list","IconBookmark","BuildOrderTable","AttachmentPanel","model_type","model_id","NotesPanel","issueOrder","sales_order_issue","preFormWarning","successMessage","cancelOrder","sales_order_cancel","holdOrder","sales_order_hold","shipOrder","sales_order_complete","accept_incomplete","completeOrder","soActions","canEdit","canIssue","PENDING","ON_HOLD","canCancel","IN_PROGRESS","canHold","autoComplete","isSet","canShip","canComplete","SHIPPED","PrimaryActionButton","AdminButton","BarcodeActionDropdown","barcode_hash","PrintingActions","OptionsActionDropdown","EditItemAction","DuplicateItemAction","HoldItemAction","CancelItemAction","orderBadges","isLoading","StatusRenderer","size","subtitle","t","InstanceDetail","Stack","PageDetail","hasChangePermission","PanelGroup"],"mappings":"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"}
