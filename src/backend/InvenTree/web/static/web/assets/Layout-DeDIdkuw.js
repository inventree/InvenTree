import{ce as ht,cf as pt,cg as gt,ch as mt,ci as U,cj as W,j as e,ck as ft,a1 as ie,F as se,r as h,cl as He,O as Me,bN as xt,cm as St,U as Pe,cn as jt,N as _t,co as bt,cp as vt,cq as yt,cr as kt,cs as Et,u as ce,i as l,aG as $,ct as At,cu as wt,cv as ae,bL as N,bM as V,ae as Ct,cw as It,cx as Rt,cy as y,G as I,B as T,cz as Nt,cA as Vt,A as D,cB as zt,b0 as Ue,b1 as Ot,cC as Dt,cD as Lt,bz as Tt,cE as Ht,S as oe,bR as Ee,cF as Mt,D as Ae,cG as we,k as Pt,cH as We,bT as Z,z as Ce,bQ as Ie,bW as de,I as Ut,C as Be,L as Fe,d as Qe,cI as Ke,cJ as Wt,Y as Bt,cK as Ft,bY as le,cL as Qt,a4 as ue,c7 as Kt,cM as $t,be as Gt,cN as ve,s as Zt,cO as Xt,aT as qt,c1 as Yt,cP as Jt,b2 as es,bX as re}from"./vendor-C9xuDR-n.js";import{u as $e,b as B,v as ye,l as ts,n as F,f as Ge,m as A,U as v,a as J,e as ee,A as te,M as Ze,h as ss,g as Xe,o as pe,p as ns,r as qe,c as is,d as os}from"./index-CjCZvRJF.js";import{a as Ye,s as rs,l as as,d as ls,D as cs,A as ds,g as De}from"./links-Blx29b59.js";import{o as us,B as hs,a as Q,S as Re,I as Le,k as Ne,n as ps,u as Je,O as gs,j as ms}from"./ThemeContext-s5vo4YrD.js";import{u as fs}from"./UsePluginUIFeature-3HsPAvlS.js";import{A as xs}from"./Alerts-K0Anwiwi.js";import{L as ke,N as Ss}from"./DesktopAppView-EZRUo9CM.js";import{u as js}from"./UseInstanceName-DJfA7ofP.js";import{R as _s}from"./UseForm-D7tPXWOh.js";import{g as bs}from"./ModelType-cJPvkb0K.js";import"./PluginSource-BoO63rMJ.js";import"./ActionButton-C7Sx5Rz-.js";const vs=()=>ht({opened:!1,empty:!1,selected:-1,listId:"",query:"",registeredActions:new Set}),ys=s=>pt(s);function X(s,t){const n=t.getState();t.setState({...n,...s(t.getState())})}function et(s){X(()=>({opened:!0,selected:-1}),s)}function tt(s){X(()=>({opened:!1}),s)}function st(s){X(t=>({opened:!t.opened,selected:t.opened?t.selected:-1}),s)}function nt(s,t){t.updateState(n=>({...n,selected:s}))}function ks(s,t){t.updateState(n=>({...n,listId:s}))}function he(s,t=document){const n=t.querySelector(s);if(n)return n;const o=t instanceof ShadowRoot?t.host.children:t.children;for(let r=0;r<o.length;r+=1){const i=o[r];if(i.shadowRoot){const d=he(s,i.shadowRoot);if(d)return d}const a=he(s,i);if(a)return a}return null}function ge(s,t){var m,c;const n=t.getState(),o=n.listId?he(`#${n.listId}`):null,r=o==null?void 0:o.querySelector("[data-selected]"),i=(o==null?void 0:o.querySelectorAll("[data-action]"))??[],a=s===-1?i.length-1:s===i.length?0:s,d=gt(a,0,i.length-1);return r==null||r.removeAttribute("data-selected"),(m=i[d])==null||m.scrollIntoView({block:"nearest"}),(c=i[d])==null||c.setAttribute("data-selected","true"),nt(d,t),d}function Es(s){return ge(s.getState().selected+1,s)}function As(s){return ge(s.getState().selected-1,s)}function ws(s){const t=s.getState(),n=he(`#${t.listId} [data-selected]`);n==null||n.click()}function Cs(s,t){const n=t.getState();return n.registeredActions.add(s),()=>{n.registeredActions.delete(s)}}function Is(s,t){X(()=>({query:s}),t),Promise.resolve().then(()=>{ge(0,t),X(n=>({empty:n.query.trim().length>0&&n.registeredActions.size===0||!1}),t)})}function Rs({clearQuery:s},t){t.updateState(n=>({...n,selected:-1,query:s?"":n.query,empty:s?!1:n.empty}))}const L={open:et,close:tt,toggle:st,updateState:X,setSelectedAction:nt,setListId:ks,selectAction:ge,selectNextAction:Es,selectPreviousAction:As,triggerSelectedAction:ws,registerAction:Cs,setQuery:Is,clearSpotlightState:Rs};function it(){const s=vs();return[s,{open:()=>et(s),close:()=>tt(s),toggle:()=>st(s)}]}const[ot,me]=it(),{open:wn,close:Cn,toggle:In}=me;function rt(s){const t=s;return t.group!==void 0&&Array.isArray(t.actions)}function Ns(s){return Array.isArray(s)?s.map(t=>t.trim()).join(",").toLowerCase().trim():typeof s=="string"?s.toLowerCase().trim():""}function Vs(s){return s.reduce((t,n)=>"actions"in n?[...t,...n.actions.map(o=>({...o,group:n.group}))]:[...t,n],[])}function zs(s){const t={},n=[];return s.forEach(o=>{o.group?(t[o.group]||(t[o.group]={pushed:!1,data:{group:o.group,actions:[]}}),t[o.group].data.actions.push(o),t[o.group].pushed||(t[o.group].pushed=!0,n.push(t[o.group].data))):n.push(o)}),n}const Os=(s,t)=>{const n=s.trim().toLowerCase(),o=[[],[]];return Vs(t).forEach(i=>{var a,d;(a=i.label)!=null&&a.toLowerCase().includes(n)?o[0].push(i):((d=i.description)!=null&&d.toLowerCase().includes(n)||Ns(i.keywords).includes(n))&&o[1].push(i)}),zs(o.flat())};function at(s,t){if(!Array.isArray(s))return[];let n=0;return s.reduce((o,r)=>{if(n>=t)return o;if(rt(r)){const i=at(r.actions,t-n);o.push({group:r.group,actions:i}),n+=i.length}else o.push(r),n+=1;return o},[])}const[Ds,q]=mt("Spotlight component was not found in tree");var H={root:"m_d2b315db",content:"m_3cd250e0",body:"m_d2abce9b",search:"m_f366a061",actionsList:"m_6e463822",action:"m_d49bb8ef",actionBody:"m_3d475731",actionSection:"m_832642f6",actionLabel:"m_6c2a1345",actionDescription:"m_a6d9d78d",empty:"m_82f78f74",footer:"m_ddcaf054",actionsGroup:"m_5a3e5f7b"};const Ls={dimmedSections:!0,highlightQuery:!1},ne=U((s,t)=>{const n=W("SpotlightAction",Ls,s),{className:o,style:r,classNames:i,styles:a,id:d,description:m,label:c,leftSection:u,rightSection:p,children:f,dimmedSections:b,highlightQuery:x,highlightColor:R,closeSpotlightOnTrigger:j,onClick:C,onMouseDown:w,keywords:P,vars:O,..._}=n,E=q(),g={classNames:i,styles:a},S=x&&typeof c=="string"?e.jsx(ft,{component:"span",highlight:E.query,color:R,...E.getStyles("actionLabel",g),children:c}):e.jsx("span",{...E.getStyles("actionLabel",g),children:c});return e.jsx(ie,{ref:t,"data-action":!0,...E.getStyles("action",{className:o,style:r,...g}),..._,onMouseDown:k=>{k.preventDefault(),w==null||w(k)},onClick:k=>{C==null||C(k),(j??E.closeOnActionTrigger)&&L.close(E.store)},tabIndex:-1,children:f||e.jsxs(e.Fragment,{children:[u&&e.jsx(se,{component:"span",mod:{position:"left",dimmed:b},...E.getStyles("actionSection",g),children:u}),e.jsxs("span",{...E.getStyles("actionBody",g),children:[S,e.jsx("span",{...E.getStyles("actionDescription",g),children:m})]}),p&&e.jsx(se,{component:"span",mod:{position:"right",dimmed:b},...E.getStyles("actionSection",g),children:p})]})})});ne.classes=H;ne.displayName="@mantine/spotlight/SpotlightAction";const fe=U((s,t)=>{const{className:n,style:o,styles:r,classNames:i,label:a,children:d,...m}=W("SpotlightActionsGroup",null,s),c=q();return e.jsx(se,{...c.getStyles("actionsGroup",{className:n,style:o,classNames:i,styles:r}),ref:t,...m,__vars:{"--spotlight-label":`'${a==null?void 0:a.replace(/'/g,"\\'")}'`},children:d})});fe.classes=H;fe.displayName="@mantine/core/SpotlightActionsGroup";const xe=U((s,t)=>{const{className:n,style:o,id:r,children:i,vars:a,classNames:d,styles:m,...c}=W("SpotlightActionsList",null,s),u=q(),p=`mantine-${h.useId().replace(/:/g,"")}`,f=r||p;return h.useEffect(()=>(L.setListId(f,u.store),()=>L.setListId("",u.store)),[]),e.jsx(He.Autosize,{...u.getStyles("actionsList",{className:n,style:o,classNames:d,styles:m}),ref:t,type:"scroll",scrollbarSize:"var(--spotlight-actions-list-padding)",offsetScrollbars:"y",id:f,...c,children:i})});xe.classes=H;xe.displayName="@mantine/spotlight/SpotlightActionsList";const Se=U((s,t)=>{const{className:n,style:o,classNames:r,styles:i,...a}=W("SpotlightEmpty",null,s),d=q();return e.jsx(se,{ref:t,...d.getStyles("empty",{classNames:r,styles:i,className:n,style:o}),...a})});Se.classes=H;Se.displayName="@mantine/spotlight/SpotlightEmpty";const Ve=U((s,t)=>{const{className:n,style:o,classNames:r,styles:i,...a}=W("SpotlightFooter",null,s),d=q();return e.jsx(se,{ref:t,...d.getStyles("footer",{className:n,classNames:r,style:o,styles:i}),...a})});Ve.classes=H;Ve.displayName="@mantine/spotlight/SpotlightFooter";function Ts(s,t){if(!s)return[];const n=()=>L.open(t);return Array.isArray(s)?s.map(o=>[o,n]):[[s,n]]}const Hs={size:600,yOffset:80,zIndex:Me("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:ot,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K",maxHeight:400},je=U((s,t)=>{const n=W("SpotlightRoot",Hs,s),{classNames:o,className:r,style:i,styles:a,unstyled:d,vars:m,store:c,children:u,query:p,onQueryChange:f,transitionProps:b,clearQueryOnClose:x,shortcut:R,tagsToIgnore:j,triggerOnContentEditable:C,disabled:w,onSpotlightOpen:P,onSpotlightClose:O,forceOpened:_,closeOnActionTrigger:E,maxHeight:g,scrollable:S,attributes:k,...M}=n,K=xt(),{opened:be,query:ct}=ys(c),dt=typeof p=="string"?p:ct,Oe=Y=>{f==null||f(Y),L.setQuery(Y,c)},ut=St({name:"Spotlight",classes:H,props:n,className:r,style:i,classNames:o,styles:a,unstyled:d,attributes:k});return Pe(Ts(R,c),j,C),jt(()=>{be?P==null||P():O==null||O()},[be]),w?null:e.jsx(Ds,{value:{getStyles:ut,query:dt,setQuery:Oe,store:c,closeOnActionTrigger:E},children:e.jsx(_t,{ref:t,...M,withCloseButton:!1,opened:be||!!_,padding:0,onClose:()=>L.close(c),className:r,style:i,classNames:yt({theme:K,classNames:[H,o],props:n,stylesCtx:void 0}),styles:vt({theme:K,styles:a,props:n,stylesCtx:void 0}),transitionProps:{...b,onExited:()=>{var Y;x&&Oe(""),L.clearSpotlightState({clearQuery:x},c),(Y=b==null?void 0:b.onExited)==null||Y.call(b)}},__vars:{"--spotlight-max-height":S?bt(g):void 0},__staticSelector:"Spotlight","data-scrollable":S||void 0,children:u})})});je.classes=H;je.displayName="@mantine/spotlight/SpotlightRoot";const Ms={size:"lg"},_e=U((s,t)=>{const{classNames:n,styles:o,onKeyDown:r,onChange:i,vars:a,value:d,...m}=W("SpotlightSearch",Ms,s),c=q(),u=c.getStyles("search"),[p,f]=h.useState(!1),b=x=>{r==null||r(x),!p&&(x.nativeEvent.code==="ArrowDown"&&(x.preventDefault(),L.selectNextAction(c.store)),x.nativeEvent.code==="ArrowUp"&&(x.preventDefault(),L.selectPreviousAction(c.store)),(x.nativeEvent.code==="Enter"||x.nativeEvent.code==="NumpadEnter")&&(x.preventDefault(),L.triggerSelectedAction(c.store)))};return e.jsx(kt,{ref:t,classNames:[{input:u.className},n],styles:[{input:u.style},o],...m,value:d??c.query,onChange:x=>{c.setQuery(x.currentTarget.value),i==null||i(x)},onKeyDown:b,onCompositionStart:()=>f(!0),onCompositionEnd:()=>f(!1)})});_e.classes=H;_e.displayName="@mantine/spotlight/SpotlightSearch";const Ps={size:600,yOffset:80,limit:1/0,zIndex:Me("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:ot,filter:Os,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K"},z=U((s,t)=>{const n=W("Spotlight",Ps,s),{searchProps:o,filter:r,query:i,onQueryChange:a,actions:d,nothingFound:m,highlightQuery:c,limit:u,...p}=n,[f,b]=Et({value:i,defaultValue:"",finalValue:"",onChange:a}),x=at(r(f,d),u).map(R=>{if(rt(R)){const j=R.actions.map(({id:C,...w})=>e.jsx(ne,{highlightQuery:c,...w},C));return e.jsx(fe,{label:R.group,children:j},R.group)}return e.jsx(ne,{highlightQuery:c,...R},R.id)});return e.jsxs(je,{...p,query:f,onQueryChange:b,ref:t,children:[e.jsx(_e,{...o}),e.jsxs(xe,{children:[x,x.length===0&&m&&e.jsx(Se,{children:m})]})]})});z.classes=H;z.displayName="@mantine/spotlight/Spotlight";z.Search=_e;z.ActionsList=xe;z.Action=ne;z.Empty=Se;z.ActionsGroup=fe;z.Footer=Ve;z.Root=je;z.open=me.open;z.close=me.close;z.toggle=me.toggle;function Us(s){return us({modal:"qr",innerProps:{navigate:s}})}function Ws(s){const t=$e(ce(r=>r.setNavigationOpen)),{user:n}=B(),o=[{id:"dashboard",label:l._({id:"7p5kLi"}),description:l._({id:"kwda2l"}),onClick:()=>{},leftSection:e.jsx($,{size:"1.2rem"})},{id:"documentation",label:l._({id:"TvY/XA"}),description:l._({id:"hqbo9J"}),onClick:()=>{window.location.href=ls.faq},leftSection:e.jsx($,{size:"1.2rem"})},{id:"about",label:l._({id:"iDxamh"}),description:l._({id:"gfhzPz"}),onClick:()=>Ye(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"server-info",label:l._({id:"mHGdhG"}),description:l._({id:"Ckl0UI"}),onClick:()=>rs(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"license-info",label:l._({id:"I/Xnkt"}),description:l._({id:"L23uA9"}),onClick:()=>as(),leftSection:e.jsx($,{size:"1.2rem"})},{id:"navigation",label:l._({id:"rmlxV1"}),description:l._({id:"xIiHCw"}),onClick:()=>t(!0),leftSection:e.jsx(At,{size:"1.2rem"})},{id:"scan",label:l._({id:"I+FvbD"}),description:l._({id:"9j/kJy"}),onClick:()=>Us(s),leftSection:e.jsx(wt,{size:"1.2rem"})}];return n!=null&&n.is_staff&&o.push({id:"admin-center",label:l._({id:"uTLn08"}),description:l._({id:"txYotp"}),onClick:()=>{},leftSection:e.jsx($,{size:"1.2rem"})}),o}var Bs="_1jb1pko0",Fs="_1jb1pko1",Qs="_1jb1pko2",Ks="_1jb1pko3",lt="_1jb1pko7",$s="_1jb1pko8",Gs="_1jb1pko9",Zs="_1jb1pkoa",Xs="_1jb1pkog";function qs(){return e.jsx("div",{className:Fs})}function Ys(){const[s,{open:t,close:n}]=ae(!1);return e.jsxs(e.Fragment,{children:[e.jsx(N,{position:"bottom-end",label:l._({id:"fNvDwV"}),children:e.jsx(V,{onClick:t,variant:"transparent",title:l._({id:"YzRRV6"}),children:e.jsx(Ct,{})})}),e.jsx(hs,{opened:s,onClose:n})]})}function Js(){return e.jsx(N,{position:"bottom-end",label:l._({id:"FcOU0s"}),children:e.jsx(V,{onClick:()=>gn.open(),variant:"transparent","aria-label":"open-spotlight",children:e.jsx(It,{})})})}function en(){const s=Q(),[t,n]=B(ce(i=>[i.user,i.username])),{colorScheme:o,toggleColorScheme:r}=Rt();return e.jsx(e.Fragment,{children:e.jsxs(y,{width:260,position:"bottom-end",children:[e.jsx(y.Target,{children:e.jsx(ie,{className:Ks,children:e.jsxs(I,{gap:7,children:[n()?e.jsx(T,{fw:500,size:"sm",style:{lineHeight:1},mr:3,children:n()}):e.jsx(Nt,{height:20,width:40,radius:ye.radiusDefault}),e.jsx(Vt,{})]})})}),e.jsxs(y.Dropdown,{children:[e.jsx(y.Label,{children:e.jsx(D,{id:"Tz0i8g"})}),e.jsx(y.Item,{leftSection:e.jsx(zt,{}),component:ke,to:"/settings/user",children:e.jsx(D,{id:"Puv7+X"})}),(t==null?void 0:t.is_staff)&&e.jsx(y.Item,{leftSection:e.jsx(Ue,{}),component:ke,to:"/settings/system",children:e.jsx(D,{id:"zNkWa6"})}),(t==null?void 0:t.is_staff)&&e.jsx(y.Item,{leftSection:e.jsx(Ot,{}),component:ke,to:"/settings/admin",children:e.jsx(D,{id:"uTLn08"})}),(t==null?void 0:t.is_staff)&&e.jsx(y.Divider,{}),e.jsx(y.Item,{onClick:r,leftSection:o==="dark"?e.jsx(Dt,{}):e.jsx(Lt,{}),c:o==="dark"?ye.colors.yellow[4]:ye.colors.blue[6],children:e.jsx(D,{id:"4i3x9F"})}),e.jsx(y.Item,{onClick:()=>Ye(),leftSection:e.jsx(Tt,{}),children:e.jsx(D,{id:"iDxamh"})}),e.jsx(y.Divider,{}),e.jsx(y.Item,{leftSection:e.jsx(Ht,{}),onClick:()=>{ts(s)},children:e.jsx(D,{id:"nOhz3x"})})]})]})})}const tn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='400'%3e%3cg%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%3e%3cpath%20fill='%23ddbc91'%20d='M200%20199.906v193.196l166.305-96.016V103.139Z'/%3e%3cpath%20fill='%23d9b383'%20d='M200%20199.906v193.196L33.695%20297.086V103.139Z'/%3e%3cpath%20fill='%23ddbc91'%20d='M366.305%20103.139%20200%20199.906%2033.695%20103.14%20200%206.899z'/%3e%3cg%20fill='%23f3f4e4'%3e%3cpath%20d='M75.27%20127.109v145.46L200%20344.583l124.73-72.012V127.109L200%20199.684Z'/%3e%3cpath%20d='M324.73%20127.11%20200%20199.684%2075.27%20127.109%20200%2054.93Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20d='M200%2054.929v144.756L75.27%20272.569V127.11z'/%3e%3cpath%20fill='%23eaeccf'%20d='M200%2054.929v144.756l124.73%2072.884V127.11z'/%3e%3cpath%20fill='%2390a8d8'%20d='M200%20199.901V296.5l83.153-48.008v-96.973zm0%200V296.5l-83.153-48.008v-96.973zm83.153-48.383L200%20199.9l-83.153-48.383L200%20103.398Z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20443.959v216.54l186.4-107.618V335.499Zm0%200v216.54l-186.4-107.618V335.499Z'/%3e%3cpath%20d='m-360.266%20335.499-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20227.419v216.54l186.4-107.619V118.96Zm0%200v216.54l-186.4-107.619V118.96Z'/%3e%3cpath%20d='m-360.266%20118.959-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667%2010.879v216.54l186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23d9b383'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%20d='M-546.667%2010.879v216.54l-186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='m-360.266-97.581-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3cg%20fill='%23f3f4e4'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.058'%3e%3cpath%20stroke-width='3'%20d='M-686.466-70.715V92.321l139.798%2080.714%20139.801-80.714V-70.715l-139.8%2081.346z'/%3e%3cpath%20stroke-width='2.999'%20d='m-406.866-70.715-139.8%2081.345-139.801-81.345%20139.8-80.902Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l-139.8%2081.692V-70.715z'/%3e%3cpath%20fill='%23eaeccf'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l139.8%2081.692V-70.715z'/%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.999'%3e%3cpath%20d='M-546.667%2010.873v108.27l93.2-53.81v-108.69zm0%200v108.27l-93.2-53.81v-108.69z'/%3e%3cpath%20d='m-453.466-43.357-93.2%2054.23-93.201-54.23%2093.2-53.935Z'/%3e%3c/g%3e%3cpath%20fill='none'%20d='M-787.948-253.366h482.56v946.733h-482.56z'/%3e%3c/svg%3e";h.forwardRef((s,t)=>e.jsx("div",{ref:t,...s,children:e.jsx(Ss,{to:"/",children:e.jsx(V,{size:28,variant:"transparent",children:e.jsx(ze,{})})})}));const ze=()=>e.jsx("img",{src:tn,alt:l._({id:"DVAy0b"}),height:28});function sn({openDrawer:s}){return e.jsx(ie,{onClick:()=>s(),"aria-label":"navigation-menu",children:e.jsx(ze,{})})}function G({title:s,links:t,beforeClick:n}){const o=Q(),r=h.useMemo(()=>t.filter(i=>!i.hidden),[t]);return r.length==0?null:e.jsx(e.Fragment,{children:e.jsxs(oe,{gap:"xs",children:[e.jsx(Ee,{}),e.jsx(Re,{size:"md",children:s}),e.jsx(Ee,{}),e.jsx(Mt,{cols:{base:1,"400px":2},type:"container",spacing:0,p:3,children:r.map(i=>e.jsx(N,{label:i.description,hidden:!i.description,children:i.link&&i.external?e.jsx(Ae,{href:i.link,children:e.jsxs(I,{wrap:"nowrap",children:[i.external&&e.jsx(Le,{icon:i.icon??"link",iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})}):e.jsx(ie,{onClick:a=>{i.link?(n==null||n(),F(i.link,o,a)):i.action&&(n==null||n(),i.action())},children:e.jsxs(I,{wrap:"nowrap",children:[i.icon&&e.jsx(Le,{icon:i.icon,iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})})},`menu-link-tooltip-${i.id}`))})]})})}const Te=[];function nn({opened:s,close:t}){return e.jsx(we,{opened:s,onClose:t,size:"lg",withCloseButton:!1,classNames:{body:Xs},children:e.jsx(on,{closeFunc:t})})}function on({closeFunc:s}){const t=B(),n=Ge(),[o,r]=h.useState(0),i=h.useRef(null),{height:a}=Pt(),d=js();h.useEffect(()=>{i.current!=null&&r(a-i.current.clientHeight-65)});const m=h.useMemo(()=>[{id:"home",title:l._({id:"7p5kLi"}),link:"/",icon:"dashboard"},{id:"parts",title:l._({id:"pmRbKZ"}),hidden:!t.hasViewPermission(A.part),link:"/part",icon:"part"},{id:"stock",title:l._({id:"blbbPS"}),link:"/stock",hidden:!t.hasViewPermission(A.stockitem),icon:"stock"},{id:"build",title:l._({id:"3ctapx"}),link:"/manufacturing/",hidden:!t.hasViewRole(v.build),icon:"build"},{id:"purchasing",title:l._({id:"UOTpFa"}),link:"/purchasing/",hidden:!t.hasViewRole(v.purchase_order),icon:"purchase_orders"},{id:"sales",title:l._({id:"mUv9U4"}),link:"/sales/",hidden:!t.hasViewRole(v.sales_order),icon:"sales_orders"},{id:"users",title:l._({id:"Sxm8rQ"}),link:"/core/index/users",icon:"user"},{id:"groups",title:l._({id:"zhrjek"}),link:"/core/index/groups",icon:"group"}],[t]),c=h.useMemo(()=>[{id:"barcode",title:l._({id:"fNvDwV"}),link:"/scan",icon:"barcode",hidden:!n.isSet("BARCODE_ENABLE")}],[t,n]),u=h.useMemo(()=>[{id:"notifications",title:l._({id:"iDNBZe"}),link:"/notifications",icon:"notification"},{id:"user-settings",title:l._({id:"ekfzWq"}),link:"/settings/user",icon:"user"},{id:"system-settings",title:l._({id:"zNkWa6"}),link:"/settings/system",icon:"system",hidden:!t.isStaff()},{id:"admin-center",title:l._({id:"uTLn08"}),link:"/settings/admin",icon:"admin",hidden:!t.isStaff()}],[t]),p=h.useMemo(()=>cs(),[]),f=h.useMemo(()=>ds(n,t),[]);return e.jsxs(We,{direction:"column",mih:"100vh",p:16,children:[e.jsxs(I,{wrap:"nowrap",children:[e.jsx(ze,{}),e.jsx(Re,{size:"xl",children:d})]}),e.jsx(Z,{h:"xs"}),e.jsx(Ce,{className:lt,p:0,children:e.jsxs(He,{h:o,type:"always",offsetScrollbars:!0,children:[e.jsx(G,{title:l._({id:"UxKoFf"}),links:m,beforeClick:s}),e.jsx(G,{title:l._({id:"Tz0i8g"}),links:u,beforeClick:s}),e.jsx(G,{title:l._({id:"7L01XJ"}),links:c,beforeClick:s}),e.jsx(Z,{h:"md"}),Te.length>0?e.jsx(G,{title:l._({id:"ohUJJM"}),links:Te,beforeClick:s}):e.jsx(e.Fragment,{})]})}),e.jsxs("div",{ref:i,children:[e.jsx(Z,{h:"md"}),e.jsx(G,{title:l._({id:"TvY/XA"}),links:p,beforeClick:s}),e.jsx(Z,{h:"md"}),e.jsx(G,{title:l._({id:"uyJsf6"}),links:f,beforeClick:s})]})]})}function rn({notification:s,onRead:t}){var a,d,m;const n=Q();let o=(a=s.target)==null?void 0:a.link;const r=(d=s.target)==null?void 0:d.model_type,i=(m=s.target)==null?void 0:m.model_id;if(r){const c=Ze[r];c!=null&&c.url_detail&&i?o=ss(r,i):c!=null&&c.url_overview&&(o=c.url_overview)}return e.jsx(Bt,{p:"xs",shadow:"xs",children:e.jsxs(I,{justify:"space-between",wrap:"nowrap",children:[e.jsx(N,{label:s.message,position:"bottom-end",hidden:!s.message,children:e.jsxs(oe,{gap:2,children:[e.jsx(Ae,{href:o?`/${Xe()}${o}`:"#",underline:"hover",target:"_blank",onClick:c=>{o&&t(),o.startsWith("/")&&F(o,n,c)},children:e.jsx(T,{size:"sm",children:s.name})}),e.jsx(T,{size:"xs",children:s.age_human})]})}),e.jsx(N,{label:l._({id:"+s1J8k"}),position:"bottom-end",children:e.jsx(V,{variant:"transparent",onClick:t,children:e.jsx(Ke,{})})})]})})}function an({opened:s,onClose:t}){var m,c;const{isLoggedIn:n}=B(),o=Q(),r=Ie({enabled:s&&n(),queryKey:["notifications",s],queryFn:async()=>J.get(ee(te.notifications_list),{params:{read:!1,limit:10,ordering:"-creation"}}).then(u=>u.data),refetchOnMount:!1}),i=h.useMemo(()=>{var u,p;return(((p=(u=r.data)==null?void 0:u.results)==null?void 0:p.length)??0)>0},[r.data]),a=h.useCallback(()=>{J.get(ee(te.notifications_readall),{params:{read:!1}}).catch(u=>{}).then(u=>{r.refetch()})},[]),d=h.useCallback(u=>{J.patch(ee(te.notifications_list,u.pk),{read:!0}).then(()=>{r.refetch()}).catch(()=>{r.refetch()})},[]);return e.jsx(we,{opened:s,size:"md",position:"right",onClose:t,withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(I,{justify:"space-between",wrap:"nowrap",children:[e.jsx(Re,{size:"lg",children:l._({id:"iDNBZe"})}),e.jsxs(I,{justify:"end",wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"onllUU"}),children:e.jsx(V,{variant:"transparent",onClick:()=>{a()},children:e.jsx(Ke,{})})}),e.jsx(N,{label:l._({id:"/WA/tl"}),children:e.jsx(V,{onClick:u=>{t(),F("/notifications/unread",o,u)},variant:"transparent",children:e.jsx(Wt,{})})})]})]}),children:e.jsx(Ne,{label:"NotificationDrawer",children:e.jsxs(oe,{gap:"xs",children:[e.jsx(Ee,{}),!r.isFetching&&!r.isLoading&&!r.isError&&!i&&e.jsx(de,{color:"green",icon:e.jsx(Ut,{}),children:e.jsx(T,{size:"sm",children:l._({id:"t2pqHO"})})}),i&&((c=(m=r.data)==null?void 0:m.results)==null?void 0:c.map(u=>e.jsx(rn,{notification:u,onRead:()=>d(u)},`notification-${u.pk}`))),r.isFetching&&e.jsx(Be,{children:e.jsx(Fe,{size:"sm"})}),r.isError&&e.jsx(de,{color:"red",title:l._({id:"SlfejT"}),icon:e.jsx(Qe,{}),children:e.jsx(T,{size:"sm",children:l._({id:"KEHQO1"})})})]})})})}function ln({searchText:s,query:t,navigate:n,onClose:o,onRemove:r,onResultClick:i}){const a=h.useMemo(()=>bs(t.model),[t.model]),d=h.useMemo(()=>t.overviewUrl?t.overviewUrl:a.url_overview,[t,a]),m=h.useCallback(c=>{if(ns(c),d){const u=`${d}?search=${s}`;qe(c)||o(),F(u,n,c)}else Zt({title:l._({id:"FXAptz"}),message:l._({id:"RPZ4Cq"}),color:"red",icon:e.jsx(Qe,{})})},[d,s]);return t.results.count==0?null:e.jsxs(le.Item,{value:t.model,children:[e.jsx(le.Control,{component:"div",children:e.jsxs(I,{justify:"space-between",children:[e.jsxs(I,{justify:"left",gap:5,wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"XN9Er0"}),position:"top-start",children:e.jsx(V,{size:"sm",variant:"transparent",radius:"xs","aria-label":`view-all-results-${t.searchKey??t.model}`,disabled:!d,onClick:m,children:e.jsx(Xt,{})})}),e.jsx(T,{size:"lg",children:t.title??a.label_multiple}),e.jsxs(T,{size:"sm",style:{fontStyle:"italic"},children:[" ","- ",t.results.count," ",e.jsx(D,{id:"mO8KLE"})]})]}),e.jsxs(I,{justify:"right",wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"8OvYje"}),position:"top-end",children:e.jsx(V,{size:"sm",color:"red",variant:"transparent",radius:"xs","aria-label":`remove-search-group-${t.model}`,onClick:()=>r(t.model),children:e.jsx(qt,{})})}),e.jsx(Z,{})]})]})}),e.jsx(le.Panel,{children:e.jsx(oe,{"aria-label":`search-group-results-${t.model}`,children:t.results.results.map(c=>e.jsx(Ae,{underline:"never",onClick:u=>i(t.model,c.pk,u),children:e.jsx(_s,{instance:c,model:t.model})},`result-${t.model}-${c.pk}`))})})]},t.model)}function cn({opened:s,onClose:t}){const[n,o]=h.useState(""),[r]=Ft(n,500),i=B(),a=pe(),[d,m]=h.useState(!1),[c,u]=h.useState(!1),[p,f]=h.useState(!1);h.useEffect(()=>{m(a.isSet("SEARCH_REGEX",!1)),u(a.isSet("SEARCH_WHOLE",!1)),f(a.isSet("SEARCH_NOTES",!1))},[a.isSet("SEARCH_REGEX",!1),a.isSet("SEARCH_WHOLE",!1),a.isSet("SEARCH_NOTES",!1)]);const b=h.useMemo(()=>[{model:A.part,parameters:{active:a.isSet("SEARCH_HIDE_INACTIVE_PARTS")?!0:void 0},enabled:i.hasViewRole(v.part)&&a.isSet("SEARCH_PREVIEW_SHOW_PARTS")},{model:A.supplierpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:i.hasViewRole(v.part)&&i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS")},{model:A.manufacturerpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:i.hasViewRole(v.part)&&i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS")},{model:A.partcategory,parameters:{},enabled:i.hasViewRole(v.part_category)&&a.isSet("SEARCH_PREVIEW_SHOW_CATEGORIES")},{model:A.stockitem,parameters:{part_detail:!0,location_detail:!0,in_stock:a.isSet("SEARCH_PREVIEW_HIDE_UNAVAILABLE_STOCK")?!0:void 0},enabled:i.hasViewRole(v.stock)&&a.isSet("SEARCH_PREVIEW_SHOW_STOCK")},{model:A.stocklocation,parameters:{},enabled:i.hasViewRole(v.stock_location)&&a.isSet("SEARCH_PREVIEW_SHOW_LOCATIONS")},{model:A.build,parameters:{part_detail:!0},enabled:i.hasViewRole(v.build)&&a.isSet("SEARCH_PREVIEW_SHOW_BUILD_ORDERS")},{model:A.company,overviewUrl:"/purchasing/index/suppliers",searchKey:"supplier",title:l._({id:"9RecCt"}),parameters:{},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.company,overviewUrl:"/purchasing/index/manufacturers",searchKey:"manufacturer",title:l._({id:"E0ub4Q"}),parameters:{},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.company,overviewUrl:"/sales/index/customers",searchKey:"customer",title:l._({id:"NihQNk"}),parameters:{},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.purchaseorder,parameters:{supplier_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_PURCHASE_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS")},{model:A.salesorder,parameters:{customer_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_SALES_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDERS")},{model:A.salesordershipment,parameters:{},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDER_SHIPMENTS")},{model:A.returnorder,parameters:{customer_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_RETURN_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.return_order)&&a.isSet("SEARCH_PREVIEW_SHOW_RETURN_ORDERS")}],[i,a]),x=h.useMemo(()=>b.filter(g=>g.enabled),[b]);h.useEffect(()=>{j.refetch()},[r]);const j=Ie({queryKey:["search",r,d,c,p],queryFn:async()=>{if(!r)return[];const g={offset:0,limit:a.getSetting("SEARCH_PREVIEW_RESULTS","10"),search:r,search_regex:d,search_whole:c,search_notes:p};return x.forEach(S=>{const k=S.searchKey||S.model;g[k]=S.parameters}),J.post(ee(te.api_search),g).then(S=>S.data)}}),[C,w]=h.useState([]);h.useEffect(()=>{if(j.data){let g=x.filter(S=>(S.searchKey??S.model)in j.data);for(const S in j.data){const k=g.find(M=>(M.searchKey??M.model)==S);k&&(k.results=j.data[S])}g=g.filter(S=>S.results.count>0),w(g)}else w([])},[j.data]);function P(g){w(C.filter(S=>S.model!=g))}function O(){o(""),t()}const _=Q();function E(g,S,k){const M=Ze[g];if(M.url_detail==null)return;qe(k)||O();const K=M.url_detail.replace(":pk",S.toString());F(K,_,k)}return e.jsx(we,{opened:s,size:"xl",onClose:O,position:"right",withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(I,{justify:"space-between",gap:1,wrap:"nowrap",children:[e.jsx(Kt,{"aria-label":"global-search-input",placeholder:l._({id:"Dwt0g3"}),value:n,onChange:g=>o(g.currentTarget.value),leftSection:e.jsx(ue,{size:"0.8rem"}),rightSection:n&&e.jsx($t,{color:"red",onClick:()=>o("")}),styles:{root:{width:"100%"}}}),e.jsx(N,{label:l._({id:"C0TDNl"}),position:"bottom-end",children:e.jsx(V,{size:"lg",variant:"transparent",onClick:()=>j.refetch(),children:e.jsx(Gt,{})})}),e.jsxs(y,{position:"bottom-end",children:[e.jsx(y.Target,{children:e.jsx(N,{label:l._({id:"9UYKcs"}),position:"bottom-end",children:e.jsx(V,{size:"lg",variant:"transparent",children:e.jsx(Ue,{})})})}),e.jsxs(y.Dropdown,{children:[e.jsx(y.Label,{children:l._({id:"9UYKcs"})}),e.jsx(y.Item,{children:e.jsx(ve,{label:l._({id:"roauu/"}),checked:c,onChange:g=>u(g.currentTarget.checked)})}),e.jsx(y.Item,{children:e.jsx(ve,{label:l._({id:"qkCZlJ"}),checked:d,onChange:g=>m(g.currentTarget.checked)})}),e.jsx(y.Item,{children:e.jsx(ve,{label:l._({id:"74yzDd"}),checked:p,onChange:g=>f(g.currentTarget.checked)})})]})]})]}),children:e.jsxs(Ne,{label:"SearchDrawer",children:[j.isFetching&&e.jsx(Be,{children:e.jsx(Fe,{})}),!j.isFetching&&!j.isError&&e.jsx(oe,{gap:"md",children:e.jsx(le,{multiple:!0,defaultValue:x.map(g=>g.model),children:C.map((g,S)=>e.jsx(ln,{searchText:r,query:g,navigate:_,onClose:O,onRemove:k=>P(k),onResultClick:(k,M,K)=>E(k,M,K)},S))})}),j.isError&&e.jsx(de,{color:"red",radius:"sm",variant:"light",title:l._({id:"SlfejT"}),icon:e.jsx(Qt,{size:"1rem"}),children:e.jsx(D,{id:"hJCuaV"})}),r&&!j.isFetching&&!j.isError&&C.length==0&&e.jsx(de,{color:"blue",radius:"sm",variant:"light",title:l._({id:"MA3x23"}),icon:e.jsx(ue,{size:"1rem"}),children:e.jsx(D,{id:"dTtbrX"})})]})})}function dn(){const[s,t]=$e(ce(_=>[_.setNavigationOpen,_.navigationOpen])),[n]=is(ce(_=>[_.server])),[o,{open:r,close:i}]=ae(t),[a,{open:d,close:m}]=ae(!1);Pe([["/",()=>{d()}],["mod+/",()=>{d()}]]);const[c,{open:u,close:p}]=ae(!1),{isLoggedIn:f}=B(),[b,x]=h.useState(0),R=Ge(),j=pe(),C=h.useMemo(()=>{var _;return(_=n.customize)==null?void 0:_.navbar_message},[n.customize]),w=Yt(),P=Ie({queryKey:["notification-count",w],enabled:f()&&w==="visible",queryFn:async()=>!f()||w!="visible"?null:J.get(ee(te.notifications_list),{params:{read:!1,limit:1}}).then(_=>{var E;return x(((E=_==null?void 0:_.data)==null?void 0:E.count)??0),_.data??null}),refetchInterval:60*1e3,refetchOnMount:!0});h.useEffect(()=>{t!==o&&s(o)},[o]),h.useEffect(()=>{t!==o&&(t?r():i())},[t]);const O=h.useMemo(()=>j.isSet("STICKY_HEADER",!0)?{position:"sticky",zIndex:10,top:0}:{},[j]);return e.jsxs("div",{className:Bs,style:O,children:[e.jsx(cn,{opened:a,onClose:m}),e.jsx(nn,{opened:o,close:i}),e.jsx(an,{opened:c,onClose:()=>{P.refetch(),p()}}),e.jsx(Ce,{className:Qs,size:"100%",children:e.jsxs(I,{justify:"space-between",children:[e.jsxs(I,{children:[e.jsx(sn,{openDrawer:r}),e.jsx(un,{})]}),C&&e.jsx(T,{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:C}})}),e.jsxs(I,{children:[e.jsx(N,{position:"bottom-end",label:l._({id:"A1taO8"}),children:e.jsx(V,{onClick:d,variant:"transparent","aria-label":"open-search",children:e.jsx(ue,{})})}),j.isSet("SHOW_SPOTLIGHT")&&e.jsx(Js,{}),R.isSet("BARCODE_ENABLE")&&e.jsx(Ys,{}),e.jsx(Jt,{radius:"lg",size:"18",label:b,color:"red",disabled:b<=0,inline:!0,children:e.jsx(N,{position:"bottom-end",label:l._({id:"iDNBZe"}),children:e.jsx(V,{onClick:u,variant:"transparent","aria-label":"open-notifications",children:e.jsx(es,{})})})}),e.jsx(xs,{}),e.jsx(en,{})]})]})})]})}function un(){const s=B(),t=Q(),n=ps(":tabName/*"),o=n==null?void 0:n.params.tabName,r=De(s),i=pe(),a=h.useMemo(()=>i.isSet("ICONS_IN_NAVBAR",!1),[i]),d=fs({featureType:"navigation",context:{}}),m=h.useMemo(()=>{const c=[];return De(s).forEach(p=>{p.role&&!s.hasViewRole(p.role)||c.push(e.jsx(re.Tab,{value:p.name,leftSection:a&&p.icon&&e.jsx(V,{variant:"transparent",children:p.icon}),onClick:f=>F(`/${p.name}`,t,f),children:e.jsx(ie,{component:"a",href:os(`/${Xe()}/${p.name}`),children:p.title})},p.name))}),d.forEach(p=>{c.push(e.jsx(re.Tab,{value:p.options.title,onClick:f=>F(p.options.options.url,t,f),children:p.options.title},p.options.key))}),c},[d,r,s,a]);return e.jsx(re,{defaultValue:"home",classNames:{root:$s,list:Gs,tab:Zs},value:o,children:e.jsx(re.List,{children:m.map(c=>c)})})}const hn=({children:s})=>{const t=Je(),{isLoggedIn:n}=B();return n()?s:e.jsx(ms,{to:"/logged-in",state:{redirectUrl:t.pathname,queryParams:t.search,anchor:t.hash}})},[pn,gn]=it();function Rn(){const s=Q(),t=Je(),n=pe(),o=Ws(s),[r,i]=h.useState(o),[a,d]=h.useState(!1);return h.useEffect(()=>{a&&(i(o),d(!1))},[t]),e.jsx(hn,{children:e.jsxs(We,{direction:"column",mih:"100vh",children:[e.jsx(dn,{}),e.jsx(Ce,{className:lt,size:"100%",children:e.jsx(Ne,{label:"layout",children:e.jsx(gs,{})})}),e.jsx(Z,{h:"xl"}),e.jsx(qs,{}),n.isSet("SHOW_SPOTLIGHT")&&e.jsx(z,{actions:r,store:pn,highlightQuery:!0,searchProps:{leftSection:e.jsx(ue,{size:"1.2rem"}),placeholder:l._({id:"YIix5Y"})},shortcut:["mod + K"],nothingFound:l._({id:"cNfZ4r"})})]})})}export{hn as ProtectedRoute,Rn as default,gn as firstSpotlight,pn as firstStore};
//# sourceMappingURL=Layout-DeDIdkuw.js.map
