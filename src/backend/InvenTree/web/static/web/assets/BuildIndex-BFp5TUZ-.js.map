{"version":3,"file":"BuildIndex-BFp5TUZ-.js","sources":["../../../../../../frontend/src/pages/build/BuildIndex.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Stack } from '@mantine/core';\nimport { IconCalendar, IconTable, IconTools } from '@tabler/icons-react';\nimport { useMemo } from 'react';\n\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport type { TableFilter } from '@lib/types/Filters';\nimport { useLocalStorage } from '@mantine/hooks';\nimport SegmentedIconControl from '../../components/buttons/SegmentedIconControl';\nimport OrderCalendar from '../../components/calendar/OrderCalendar';\nimport PermissionDenied from '../../components/errors/PermissionDenied';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport { useGlobalSettingsState } from '../../states/SettingsStates';\nimport { useUserState } from '../../states/UserState';\nimport { PartCategoryFilter } from '../../tables/Filter';\nimport { BuildOrderTable } from '../../tables/build/BuildOrderTable';\n\nfunction BuildOrderCalendar() {\n  const globalSettings = useGlobalSettingsState();\n\n  const calendarFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'external',\n        label: t`External`,\n        description: t`Show external build orders`,\n        active: globalSettings.isSet('BUILDORDER_EXTERNAL_BUILDS')\n      },\n      PartCategoryFilter()\n    ];\n  }, [globalSettings]);\n\n  return (\n    <OrderCalendar\n      model={ModelType.build}\n      role={UserRoles.build}\n      params={{ outstanding: true }}\n      filters={calendarFilters}\n    />\n  );\n}\n\nfunction BuildOverview({\n  view\n}: {\n  view: string;\n}) {\n  switch (view) {\n    case 'calendar':\n      return <BuildOrderCalendar />;\n    case 'table':\n    default:\n      return <BuildOrderTable />;\n  }\n}\n\n/**\n * Build Order index page\n */\nexport default function BuildIndex() {\n  const user = useUserState();\n\n  const [buildOrderView, setBuildOrderView] = useLocalStorage<string>({\n    key: 'buildOrderView',\n    defaultValue: 'table'\n  });\n\n  const panels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'buildorders',\n        label: t`Build Orders`,\n        content: <BuildOverview view={buildOrderView} />,\n        icon: <IconTools />,\n        controls: (\n          <SegmentedIconControl\n            value={buildOrderView}\n            onChange={setBuildOrderView}\n            data={[\n              { value: 'table', label: t`Table View`, icon: <IconTable /> },\n              {\n                value: 'calendar',\n                label: t`Calendar View`,\n                icon: <IconCalendar />\n              }\n            ]}\n          />\n        )\n      }\n    ];\n  }, [buildOrderView, setBuildOrderView]);\n\n  if (!user.isLoggedIn() || !user.hasViewRole(UserRoles.build)) {\n    return <PermissionDenied />;\n  }\n\n  return (\n    <Stack>\n      <PageDetail title={t`Manufacturing`} actions={[]} />\n      <PanelGroup\n        pageKey='build-index'\n        panels={panels}\n        model='manufacturing'\n        id={null}\n      />\n    </Stack>\n  );\n}\n"],"names":["BuildOrderCalendar","globalSettings","useGlobalSettingsState","calendarFilters","useMemo","name","label","_i18n","_","id","description","active","isSet","PartCategoryFilter","jsx","OrderCalendar","ModelType","build","UserRoles","outstanding","BuildOverview","view","BuildOrderTable","BuildIndex","user","useUserState","buildOrderView","setBuildOrderView","useLocalStorage","key","defaultValue","panels","content","icon","IconTools","controls","SegmentedIconControl","value","IconTable","IconCalendar","isLoggedIn","hasViewRole","PermissionDenied","Stack","PageDetail","PanelGroup"],"mappings":"o+BAoBA,SAASA,GAAqB,CAC5B,MAAMC,EAAiBC,EAAuB,EAExCC,EAAiCC,EAAAA,QAAQ,IACtC,CACL,CACEC,KAAM,WACNC,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAW,EAClBC,YAAWH,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAA6B,EAC1CE,OAAQV,EAAeW,MAAM,4BAA4B,CAC3D,EACAC,GAAoB,EAErB,CAACZ,CAAc,CAAC,EAGjB,OAAAa,EAAA,IAACC,GACC,MAAOC,EAAUC,MACjB,KAAMC,EAAUD,MAChB,OAAQ,CAAEE,YAAa,EAAA,EACvB,QAAShB,EACT,CAEN,CAEA,SAASiB,EAAc,CACrBC,KAAAA,CAGF,EAAG,CACD,OAAQA,EAAI,CACV,IAAK,WACH,aAAQrB,EAAqB,EAAA,EAC/B,IAAK,QACL,QACE,aAAQsB,EAAkB,EAAA,CAAA,CAEhC,CAKA,SAAwBC,GAAa,CACnC,MAAMC,EAAOC,EAAa,EAEpB,CAACC,EAAgBC,CAAiB,EAAIC,EAAwB,CAClEC,IAAK,iBACLC,aAAc,OAAA,CACf,EAEKC,EAAsB3B,EAAAA,QAAQ,IAC3B,CACL,CACEC,KAAM,cACNC,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAe,EACtBuB,QAASlB,EAAAA,IAACM,EAAc,CAAA,KAAMM,CAAkB,CAAA,EAChDO,WAAOC,EAAY,EAAA,EACnBC,eACGC,EACC,CAAA,MAAOV,EACP,SAAUC,EACV,KAAM,CACJ,CAAEU,MAAO,QAAS/B,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAa,EAAEwB,WAAOK,EAAS,CAAA,CAAA,CAAA,EACxD,CACED,MAAO,WACP/B,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAgB,EACvBwB,WAAOM,EAAY,CAAA,CAAA,CAAA,CACpB,CACD,CAAA,CAAA,CAGP,EAEF,CAACb,EAAgBC,CAAiB,CAAC,EAElC,MAAA,CAACH,EAAKgB,cAAgB,CAAChB,EAAKiB,YAAYvB,EAAUD,KAAK,QACjDyB,EAAmB,EAAA,SAI1BC,EACC,CAAA,SAAA,CAAC7B,EAAAA,IAAA8B,EAAA,CAAW,MAAMrC,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAe,EAAG,QAAS,CAAA,EAAG,EACjDK,MAAC+B,GACC,QAAQ,cACR,OAAAd,EACA,MAAM,gBACN,GAAI,IAAK,CAAA,CAAA,EAEb,CAEJ"}
